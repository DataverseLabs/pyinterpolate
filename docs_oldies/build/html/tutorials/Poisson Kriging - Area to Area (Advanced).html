
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Poisson Kriging - Area to Area Kriging &#8212; Pyinterpolate 0.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Poisson Kriging - Area to Point Kriging" href="Poisson%20Kriging%20-%20Area%20to%20Point%20%28Advanced%29.html" />
    <link rel="prev" title="Poisson Kriging - centroid based approach - tutorial" href="Poisson%20Kriging%20-%20Centroid%20Based%20%28Advanced%29.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Poisson-Kriging---Area-to-Area-Kriging">
<h1>Poisson Kriging - Area to Area Kriging<a class="headerlink" href="#Poisson-Kriging---Area-to-Area-Kriging" title="Permalink to this heading">¶</a></h1>
<section id="Table-of-Contents:">
<h2>Table of Contents:<a class="headerlink" href="#Table-of-Contents:" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Load areal and point data,</p></li>
<li><p>Load semivariogram (regularized),</p></li>
<li><p>Remove 10% of areal dataset,</p></li>
<li><p>Predict values at unknown locations,</p></li>
<li><p>Analyse Forecast Bias and Root Mean Squared Error of prediction.</p></li>
</ol>
</section>
<section id="Level:-Advanced">
<h2>Level: Advanced<a class="headerlink" href="#Level:-Advanced" title="Permalink to this heading">¶</a></h2>
</section>
<section id="Changelog">
<h2>Changelog<a class="headerlink" href="#Changelog" title="Permalink to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Change description</p></th>
<th class="head"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2021-05-28</p></td>
<td><p>Updated paths for input/output data</p></td>
<td><p>&#64;szymon-datalions</p></td>
</tr>
<tr class="row-odd"><td><p>2021-05-11</p></td>
<td><p>Refactored TheoreticalSemivariogram class</p></td>
<td><p>&#64;szymon-datalions</p></td>
</tr>
<tr class="row-even"><td><p>2021-03-31</p></td>
<td><p>Update related to the change of semivariogram weighting. Updated cancer rates data.</p></td>
<td><p>&#64;szymon-datalions</p></td>
</tr>
</tbody>
</table>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this heading">¶</a></h2>
<p>To start this tutorial it is required to understand concepts in the <strong>Ordinary and Simple Kriging</strong> and <strong>Semivariogram Regularization</strong> tutorials.</p>
<p>Poisson Kriging technique is used to model spatial count data. We are analyzing special case where data is counted over areas. Those areas may have irregular shapes and sizes beacuse they represent administrative regions.</p>
<p>In this tutorial we try to predict rates of Breast Cancer in Pennsylvania counties. Along with areal data we use U.S. Census 2010 data for population blocks.</p>
<blockquote>
<div><p>Breast cancer rates data is stored in the shapefile in folder <code class="docutils literal notranslate"><span class="pre">sample_data/areal_data/cancer_data.shp</span></code>.</p>
</div></blockquote>
<blockquote>
<div><p>Population blocks data is stored in the shapefile in folder <code class="docutils literal notranslate"><span class="pre">sample_data/population_data/cancer_population_base.shp</span></code></p>
</div></blockquote>
<p>In tutorial <strong>Poisson Kriging - Centroid based approach</strong> we’ve made assumption that all areas have the same size and shape. This wasn’t true. Now we use Area-to-Area Kriging technique and predict and evaluate missing values.</p>
<p>Area-to-Area and Area-to-Point Poisson Kriging are slower than simplified Kriging with Centroids, but gives more reliable results because they are tuned to areal size and shape.</p>
<p>This tutorial covers following steps:</p>
<ol class="arabic simple">
<li><p>Read and explore data,</p></li>
<li><p>Load semivariogram model,</p></li>
<li><p>Prepare training and test data,</p></li>
<li><p>Predict values of unknown locations and calculate forecast bias and root mean squared error,</p></li>
<li><p>Analyse error metrics.</p></li>
</ol>
</section>
<section id="1)-Read-and-explore-data">
<h2>1) Read and explore data<a class="headerlink" href="#1)-Read-and-explore-data" title="Permalink to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import pandas as pd
import geopandas as gpd

from pyinterpolate.io_ops import prepare_areal_shapefile, get_points_within_area
from pyinterpolate.semivariance import TheoreticalSemivariogram
from pyinterpolate.kriging import ArealKriging
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>areal_data_file = &#39;../sample_data/areal_data/cancer_data.shp&#39;
point_data_file = &#39;../sample_data/population_data/cancer_population_base.shp&#39;

areal_id_column_name = &#39;FIPS&#39;
areal_val_column_name = &#39;rate&#39;
points_val_column_name = &#39;POP10&#39;


areal_data = prepare_areal_shapefile(areal_data_file,
                                     id_column_name=areal_id_column_name,
                                     value_column_name=areal_val_column_name)
point_data = get_points_within_area(areal_data_file, point_data_file, areal_id_col_name=areal_id_column_name,
                                   points_val_col_name=points_val_column_name)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Lets take a look into a map of areal counts

gdf = gpd.read_file(areal_data_file)
gdf.plot(column=&#39;rate&#39;, cmap=&#39;Spectral_r&#39;, legend=True)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f26b7f94310&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Poisson_Kriging_-_Area_to_Area_(Advanced)_4_1.png" src="../_images/tutorials_Poisson_Kriging_-_Area_to_Area_(Advanced)_4_1.png" />
</div>
</div>
<section id="Clarification:">
<h3>Clarification:<a class="headerlink" href="#Clarification:" title="Permalink to this heading">¶</a></h3>
<p>It is good idea to look into the spatial patterns in dataset and to visually check if our data do not have any NaN values. We use geopandas GeoDataFrame plot function for it with color map which is diverging color classes well.</p>
</section>
</section>
<section id="2)-Load-semivariogram-model">
<h2>2) Load semivariogram model<a class="headerlink" href="#2)-Load-semivariogram-model" title="Permalink to this heading">¶</a></h2>
<p>In this step we load regularized semivariogram from the tutorial <strong>Semivariogram Regularization (Intermediate)</strong>. You can always perform semivariogram regulariztion along with the Poisson Kriging but it is a very long process and it is more convenient to separate those two steps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>semivariogram = TheoreticalSemivariogram()  # Create TheoreticalSemivariogram object
semivariogram.import_model(&#39;output/regularized_model.csv&#39;)  # Load regularized semivariogram
</pre></div>
</div>
</div>
</section>
<section id="3)-Prepare-training-and-test-data">
<h2>3) Prepare training and test data<a class="headerlink" href="#3)-Prepare-training-and-test-data" title="Permalink to this heading">¶</a></h2>
<p>We simply remove 10% of random ID’s from areal dataset (the same for points) and create four arrays: two training arrays with areal and point geometry and values and two test arrays with the same categories of data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Remove 10% of rows (values) to test our model

def create_test_areal_set(areal_dataset, points_dataset, frac=0.1):
    &quot;&quot;&quot;
    Function creates set with random areas for tests

    INPUT:
    :param areal_dataset: (numpy array) array with rows of areal records,
    :param points_dataset: (numpy array) array with rows of points records,
    :param frac: (float) number of elements in a test set

    OUTPUT:
    return: [training_set_areal(numpy array),
             test_set_areal (numpy array),
             training_set_points (numpy array),
             test_set_points (numpy array)]
    &quot;&quot;&quot;

    all_ids = areal_dataset[:, 0]
    training_set_size = int(len(all_ids) * (1 - frac))
    training_ids = np.random.choice(all_ids,
                                    size=training_set_size,
                                    replace=False)
    training_areas = np.array(
            [a for a in areal_dataset if a[0] in training_ids])
    test_areas = np.array(
            [a for a in areal_dataset if a[0] not in training_ids])
    training_points = np.array(
            [pt for pt in points_dataset if pt[0] in training_ids])
    test_points = np.array(
            [pt for pt in points_dataset if pt[0] not in training_ids])


    output = [training_areas, test_areas, training_points, test_points]
    return output

ar_train, ar_test, pt_train, pt_test = create_test_areal_set(areal_data, point_data)
</pre></div>
</div>
</div>
</section>
<section id="4)-Predict-values-at-unknown-locations-and-calculate-forecast-bias-and-root-mean-squared-error">
<h2>4) Predict values at unknown locations and calculate forecast bias and root mean squared error<a class="headerlink" href="#4)-Predict-values-at-unknown-locations-and-calculate-forecast-bias-and-root-mean-squared-error" title="Permalink to this heading">¶</a></h2>
<p>Do you know scikit-learn’s fit-predict-transform estimation procedure? With Kriging it is more complicated because we are fitting semivariogram model to data and we pass this fitted model into kriging estimator. That’s why package with <em>TheoreticalSemivariogram()</em> class is named <strong>fit_semivariance</strong>. You may start work with predictions with fitted semivariogram model. Area-to-Area Poisson Kriging takes three arguments during initialization:</p>
<p>=&gt; semivariogram model (fitted semivariogram model),</p>
<p>=&gt; known areas (training set),</p>
<p>=&gt; known points (training set).</p>
<p>After initilization you may perform prediction. This process requires you to control two hyperparameters:</p>
<p>=&gt; <strong>number of observations</strong> (the most important parameter - how many neighbors are affecting your area of analysis),</p>
<p>=&gt; minimum <strong>search radius</strong> (minimum search radius for analysis from your area of interest, if there are less areas than number of observations then the new, next closest neighbors are included in the analysis),</p>
<p>Why <strong>radius</strong> parameter is less important than <strong>number of observations</strong>? It is a tradeoff between mathemtical accuracy and reality. Usually your areas of interest have different shapes and sizes and with very large county and small search radius from the centroid you may not find any neighbour!</p>
<p><strong>The main difference between Area-to-Area and Centroid Poisson Kriging is that for the former you pass only variable with smaller blocks which are representing fine scale process withing area with missing value. Centroid PK is “feed” with missing area geometry too.</strong></p>
<p>Algorithm in the cell below iteratively picks one area from the test set and perform prediction. Then forecast bias which is difference between real and predicted value is calculated. Forecast Bias is useful to understand if our algorithm predictions are too low or too high (under- or overestimation). The next parameter is Root Mean Squared Error. This kind of measure tells us more about outliers and very large differences between predictions and real values. We will see it in the last part of
tutorial.</p>
<p>Your work with Poisson Kriging (or Kriging) will be usually the same: - prepare training and test data, - use training data to prepare semivariogram model, - test different hyperparameters with a test set to find optimal number of neighbors which are affecting your area of analysis, - forecast into unknown areas OR perform data smoothing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>number_of_obs = 8
radius = 60000  # 60 km

kriging_model = ArealKriging(semivariogram_model=semivariogram,
    known_areas=ar_train,
    known_areas_points=pt_train,
    kriging_type=&#39;ata&#39;)

kriged_predictions = []
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for unknown_area in ar_test:
    unknown_points = pt_test[pt_test[:, 0] == unknown_area[0]][0]

    # Predict
    try:
        predicted = kriging_model.predict(unknown_points,
                                          number_of_obs,
                                          radius)
        predicted_rates = int(predicted[0])
        fb = (unknown_area[-1] - predicted_rates)
        rmse = np.sqrt((fb)**2)

        kriged_predictions.append([unknown_area[0], predicted_rates, unknown_area[-1], fb, rmse])
    except ValueError:
        fb = np.nan
        rmse = np.nan
        kriged_predictions.append([unknown_area[0], np.nan, unknown_area[-1], fb, rmse])  # All NaN&#39;s
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>kriged_predictions = np.array(kriged_predictions)
pred_df = pd.DataFrame(data=kriged_predictions[:, 1:],
                       index=kriged_predictions[:, 0],
                       columns=[&#39;predicted&#39;, &#39;real&#39;, &#39;forecast bias&#39;, &#39;rmse&#39;])  # Store results in DataFrame
</pre></div>
</div>
</div>
</section>
<section id="5)-Analyze-Forecast-Bias-and-Root-Mean-Squared-Error-of-prediction">
<h2>5) Analyze Forecast Bias and Root Mean Squared Error of prediction<a class="headerlink" href="#5)-Analyze-Forecast-Bias-and-Root-Mean-Squared-Error-of-prediction" title="Permalink to this heading">¶</a></h2>
<p>The last step is analysis of errors. We plot two histograms: of forecast bias and of root mean squared error then we calculate base statistics of a dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Show histograms of errors

pred_df[&#39;forecast bias&#39;].plot.hist(bins=10)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f26b4e3c6d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Poisson_Kriging_-_Area_to_Area_(Advanced)_16_1.png" src="../_images/tutorials_Poisson_Kriging_-_Area_to_Area_(Advanced)_16_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pred_df[&#39;rmse&#39;].plot.hist(bins=10)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f26b4f3b9d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Poisson_Kriging_-_Area_to_Area_(Advanced)_17_1.png" src="../_images/tutorials_Poisson_Kriging_-_Area_to_Area_(Advanced)_17_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pred_df.describe()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>predicted</th>
      <th>real</th>
      <th>forecast bias</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>22.000000</td>
      <td>22.000000</td>
      <td>22.000000</td>
      <td>22.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>130.863636</td>
      <td>130.368182</td>
      <td>-0.495455</td>
      <td>8.595455</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11.482058</td>
      <td>17.691547</td>
      <td>11.449245</td>
      <td>7.344546</td>
    </tr>
    <tr>
      <th>min</th>
      <td>112.000000</td>
      <td>98.100000</td>
      <td>-13.900000</td>
      <td>0.700000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>122.250000</td>
      <td>122.125000</td>
      <td>-7.875000</td>
      <td>3.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>131.500000</td>
      <td>125.950000</td>
      <td>-2.150000</td>
      <td>7.200000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>136.000000</td>
      <td>134.550000</td>
      <td>3.350000</td>
      <td>11.575000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>161.000000</td>
      <td>192.200000</td>
      <td>31.200000</td>
      <td>31.200000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="id1">
<h3>Clarification:<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>Analysis of <strong>Forecast Bias</strong> and <strong>Root Mean Squared Error</strong> - their distribution and basic properties - could be a very useful tool to analyze model performance. However, take in mind that table above is a single test case (realization) and can be very misleading. Good idea is to repeat test dozens of times with a different training/test set division each time. After this we average results from multiple tests and we get an insight how our model behaves.</p>
<section id="NOTE:">
<h4>NOTE:<a class="headerlink" href="#NOTE:" title="Permalink to this heading">¶</a></h4>
<p>Those results are not decisive. Our sample is very small and output could be related to very fortunate sampling over areas. The good idea is to repeat experiment multiple times with other samples and average results to find out how well model is performing.</p>
<hr class="docutils" />
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Pyinterpolate</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms.html">Algorithms Explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution.html">Contribution to Pyinterpolate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../tutorials.html">Tutorials</a><ul>
      <li>Previous: <a href="Poisson%20Kriging%20-%20Centroid%20Based%20%28Advanced%29.html" title="previous chapter">Poisson Kriging - centroid based approach - tutorial</a></li>
      <li>Next: <a href="Poisson%20Kriging%20-%20Area%20to%20Point%20%28Advanced%29.html" title="next chapter">Poisson Kriging - Area to Point Kriging</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Szymon Moliński.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tutorials/Poisson Kriging - Area to Area (Advanced).ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>