
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Directional Semivariogram &#8212; pyinterpolate 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/tutorials/functional/2-1-directional-semivariogram';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Variogram Points Cloud" href="2-2-variogram-points-cloud.html" />
    <link rel="prev" title="Spatial Dependency Index" href="1-3-spatial-dependency-index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pyinterpolate 1.0.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../science/citation.html">
    Citation
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../science/bibliography.html">
    Bibliography
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../community/community.html">
    Community
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../api/api.html">
    API
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../api/changes.html">
    Changes between version 0.x and 1.x
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../contributor/development.html">
    Development
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../science/citation.html">
    Citation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../science/bibliography.html">
    Bibliography
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../community/community.html">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../api/api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../api/changes.html">
    Changes between version 0.x and 1.x
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contributor/development.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1-1-semivariogram-exploration.html">Semivariogram exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-2-semivariogram-models.html">Semivariogram models</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-3-spatial-dependency-index.html">Spatial Dependency Index</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Directional Semivariogram</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-2-variogram-points-cloud.html">Variogram Points Cloud</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="3-1-ordinary-and-simple-kriging.html">Ordinary and Simple Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-2-benchmark-kriging.html">Benchmarking Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-3-outliers-and-kriging.html">Outliers and Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-4-directional-ordinary-kriging.html">Directional Ordinary Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-5-blocks-to-points-ordinary-kriging.html">Blocks to points with Ordinary Kriging</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="4-1-semivariogram-regularization.html">Semivariogram Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-2-poisson-kriging-centroid-based.html">Poisson Kriging Centroid-based approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-3-poisson-kriging-area-to-area.html">Area-to-area Poisson Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-4-poisson-kriging-area-to-point-smoothing.html">Area-to-Point Poisson Kriging</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Directional Semivariogram</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Directional-Semivariogram">
<h1>Directional Semivariogram<a class="headerlink" href="#Directional-Semivariogram" title="Link to this heading">#</a></h1>
<p>In this tutorial, we will learn about directional semivariograms, how to set the angle of direction, and the tolerance parameter. We compare two neighbor selection methods: triangular, which is fast, and elliptical, which is accurate.</p>
<section id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Domain</strong>:</p>
<ul>
<li><p>semivariance and covariance functions</p></li>
</ul>
</li>
<li><p><strong>Package</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TheoreticalVariogram</span></code>, <code class="docutils literal notranslate"><span class="pre">ExperimentalVariogram</span></code></p></li>
</ul>
</li>
<li><p><strong>Programming</strong>:</p>
<ul>
<li><p>Python basics</p></li>
</ul>
</li>
</ul>
</section>
<section id="Table-of-contents">
<h2>Table of contents<a class="headerlink" href="#Table-of-contents" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>A directional process.</p></li>
<li><p>Create directional and isotropic semivariograms.</p></li>
<li><p>Compare directional semivariograms.</p></li>
<li><p>Compare triangular vs elliptical neighbors selection methods.</p></li>
</ol>
</section>
<section id="1.-Directional-process">
<h2>1. Directional process<a class="headerlink" href="#1.-Directional-process" title="Link to this heading">#</a></h2>
<p>Not every spatial process may be described by isotropic semivariograms. Sometimes we see a specific trend in one direction (N-S, W-E, or NE-SW, NW-SE). <code class="docutils literal notranslate"><span class="pre">Pyinterpolate</span></code> lets us model semivariance in a specific direction, or multiple directions with omnidirectional case. If you want to go straight to the code, then you should check API examples in notebooks (1) <code class="docutils literal notranslate"><span class="pre">tutorials/api-examples/a-1-2-directional-experimental-variogram</span></code> and (2)
<code class="docutils literal notranslate"><span class="pre">tutorials/api-examples/a-1-4-directional-variogram-class</span></code>. This guide is more detailed, thus recommeded for users not familiar with the directional semivariogram concept.</p>
<blockquote>
<div><p><strong>Note</strong>: if you are a machine learning enthusiast, then you can treat the direction as an additional feature to model semivariance.</p>
</div></blockquote>
</section>
<section id="2.-Create-directional-and-isotropic-semivariograms">
<h2>2. Create directional and isotropic semivariograms<a class="headerlink" href="#2.-Create-directional-and-isotropic-semivariograms" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">pyinterpolate</span> <span class="kn">import</span> <span class="n">ExperimentalVariogram</span><span class="p">,</span> <span class="n">DirectionalVariogram</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">VALUE_COL</span> <span class="o">=</span> <span class="s1">&#39;PM2.5&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../data/air_pollution.gpkg&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s1">&#39;pm2_5&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PM2.5</th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>station_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>659</th>
      <td>7.12765</td>
      <td>POINT (720513.167 300494.94)</td>
    </tr>
    <tr>
      <th>736</th>
      <td>4.66432</td>
      <td>POINT (475344.002 724090.975)</td>
    </tr>
    <tr>
      <th>861</th>
      <td>3.00739</td>
      <td>POINT (526820.46 700473.261)</td>
    </tr>
    <tr>
      <th>266</th>
      <td>7.10000</td>
      <td>POINT (748935.825 383022.087)</td>
    </tr>
    <tr>
      <th>355</th>
      <td>2.00000</td>
      <td>POINT (529001.219 443458.908)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="n">VALUE_COL</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PM2.5 concentrations in Poland&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_5_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_5_0.png" />
</div>
</div>
<section id="Including-direction-in-experimental-variogram">
<h3>Including direction in experimental variogram<a class="headerlink" href="#Including-direction-in-experimental-variogram" title="Link to this heading">#</a></h3>
<p>If we recall the first tutorial <code class="docutils literal notranslate"><span class="pre">1-1-semivariogram-exploration</span></code>, we set there three parameters:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ds</span></code>: <code class="docutils literal notranslate"><span class="pre">numpy</span> <span class="pre">array</span></code> with coordinates and observed values, for example: <code class="docutils literal notranslate"><span class="pre">[[0,</span> <span class="pre">0,</span> <span class="pre">10],</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">20]]</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_size</span></code>: we must divide our analysis area into discrete <strong>lags</strong>. <strong>Lags</strong> are intervals (usually circular) within which we check if the point has a neighbor. For example, if we look into the lag <code class="docutils literal notranslate"><span class="pre">500</span></code>, then we are going to compare one point with other points in a distance <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1000]</span></code> from this point,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_range</span></code>: This parameter represents the possible <strong>maximum range of spatial dependency</strong>. This parameter should be at most half of the extent.</p></li>
</ol>
<p>But that’s not everything! We can use other parameters:</p>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span></code>: it is a <code class="docutils literal notranslate"><span class="pre">float</span></code> in the range [0, 360]. We set the direction of the semivariogram:</p></li>
</ol>
<ul class="simple">
<li><p>0 or 180: is WE direction,</p></li>
<li><p>90 or 270 is NS direction,</p></li>
<li><p>45 or 225 is NE-SW direction,</p></li>
<li><p>135 or 315 is NW-SE direction.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code>: it is a <code class="docutils literal notranslate"><span class="pre">float</span></code> in the range [0, 1]. If we leave <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> with default <strong>1</strong>, we will always get an isotropic semivariogram. Another edge case is if we set <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> to <strong>0</strong>, then points must be placed on a single line with the beginning in the origin of the coordinate system and the angle given by the y-axis and direction parameter. If tolerance is &gt; 0 and &lt; 1, the bin is selected as an elliptical area with a major axis pointed in the same direction as the line for
0 tolerance.</p></li>
</ol>
<ul class="simple">
<li><p>The major axis size is <code class="docutils literal notranslate"><span class="pre">(tolerance</span> <span class="pre">*</span> <span class="pre">step_size)</span></code>,</p></li>
<li><p>The minor axis size is <code class="docutils literal notranslate"><span class="pre">((1</span> <span class="pre">-</span> <span class="pre">tolerance)</span> <span class="pre">*</span> <span class="pre">step_size)</span></code>,</p></li>
<li><p>The baseline point is at the center of the ellipse.</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p><code class="docutils literal notranslate"><span class="pre">dir_neighbors_selection_method</span></code>: it is <code class="docutils literal notranslate"><span class="pre">str</span></code> with possible values:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">triangle</span></code> for triangular neighbors selection which is fast and recommended for a big dataset,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> or <code class="docutils literal notranslate"><span class="pre">ellipse</span></code> for elliptical neighbors selection which is accurate but slow, recommended for small-size datasets.</p></li>
</ul>
<p>Those parameters are used to estimate semivariance and covariance in a leading direction. The <code class="docutils literal notranslate"><span class="pre">direction</span></code> and <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> parameters might be better described with the picture:</p>
<p><img alt="The visualization of directional variogram calculation" src="../../../_images/dir_semi_tutorial_graphics.jpg" /></p>
<ul class="simple">
<li><p>The top plane shows the black unit circle that represents the omnidirectional variogram. Within it, we see two ellipses: one is bright green and another is dark green.</p></li>
<li><p>The bottom plane shows a unit circle and two ellipses: the brighter yellow, and darker purple.</p></li>
<li><p>The long arrows within both circles are radii of the omnidirectional variogram or <strong>the semi-major axis</strong> of a directional ellipse. The <code class="docutils literal notranslate"><span class="pre">step_size</span></code> parameter controls its length. The shorter arrows are present only in the <strong>directional variograms</strong>. These represent the <strong>semi-minor axes</strong>. The <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> parameter controls their length, and it is always:</p></li>
<li><p>a fraction of <code class="docutils literal notranslate"><span class="pre">step_size</span></code>,</p></li>
<li><p><strong>1</strong>, in this case, a semivariogram is omnidirectional,</p></li>
<li><p>a value very close to 0 (but not 0) - then ellipse falls into line.</p></li>
<li><p>The good idea is to set <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> to 0.5 and gradually make it smaller or larger (depending on the spatial properties of a dataset).</p></li>
</ul>
<hr class="docutils" />
<p>We can start the analysis by understanding how our parameters affect the semivariogram bins range. We will set tolerance to 0.2 in each case to better visualize the effects of the leading direction.</p>
</section>
<section id="Case-1:-West-East-direction">
<h3>Case 1: West-East direction<a class="headerlink" href="#Case-1:-West-East-direction" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">SEMI_MAJOR_AXIS_SIZE</span> <span class="o">=</span> <span class="mi">40000</span>  <span class="c1"># meters</span>
<span class="n">MAX_RANGE</span> <span class="o">=</span> <span class="mi">400000</span>  <span class="c1"># meters</span>
<span class="n">TOLERANCE</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">WE_DIRECTION</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># or 180</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_var</span> <span class="o">=</span> <span class="n">ExperimentalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="n">WE_DIRECTION</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>
<span class="n">exp_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_9_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_9_0.png" />
</div>
</div>
</section>
<section id="Case-2:-North-South-direction">
<h3>Case 2: North-South direction<a class="headerlink" href="#Case-2:-North-South-direction" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">NS_DIRECTION</span> <span class="o">=</span> <span class="mi">90</span>  <span class="c1"># or 270</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_var</span> <span class="o">=</span> <span class="n">ExperimentalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="n">NS_DIRECTION</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>
<span class="n">exp_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_12_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_12_0.png" />
</div>
</div>
</section>
<section id="Case-3:-Northwest-Southeast-direction">
<h3>Case 3: Northwest-Southeast direction<a class="headerlink" href="#Case-3:-Northwest-Southeast-direction" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">NW_SE_DIRECTION</span> <span class="o">=</span> <span class="mi">135</span>  <span class="c1"># or 315</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_var</span> <span class="o">=</span> <span class="n">ExperimentalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="n">NW_SE_DIRECTION</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>
<span class="n">exp_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_15_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_15_0.png" />
</div>
</div>
</section>
<section id="Case-4:-Northeast-Southwest-direction">
<h3>Case 4: Northeast-Southwest direction<a class="headerlink" href="#Case-4:-Northeast-Southwest-direction" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">NE_SW_DIRECTION</span> <span class="o">=</span> <span class="mi">45</span>  <span class="c1"># or 225</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_var</span> <span class="o">=</span> <span class="n">ExperimentalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="n">NE_SW_DIRECTION</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>
<span class="n">exp_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_18_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_18_0.png" />
</div>
</div>
</section>
<section id="Case-5:-Isotropic-variogram---no-leading-direction">
<h3>Case 5: Isotropic variogram - no leading direction<a class="headerlink" href="#Case-5:-Isotropic-variogram---no-leading-direction" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_var</span> <span class="o">=</span> <span class="n">ExperimentalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span>
<span class="p">)</span>
<span class="n">exp_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_20_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_20_0.png" />
</div>
</div>
</section>
</section>
<section id="3.-Compare-semivariograms">
<h2>3. Compare semivariograms<a class="headerlink" href="#3.-Compare-semivariograms" title="Link to this heading">#</a></h2>
<p>We have created a set of variograms. What do we observe?</p>
<ul class="simple">
<li><p>The <strong>NE-SW</strong> variogram is very weak at describing a short-range variation (compare it to the map of air pollution from the beginning of the tutorial. Points in this direction are relatively similar).</p></li>
<li><p>The <strong>N-S</strong> variogram works well for a short range.</p></li>
<li><p>The <strong>W-E</strong> variogram catches too much variability, and lags must be longer for this direction.</p></li>
<li><p>The <strong>NW-SE</strong> variogram looks good and shows approximately linear variability change in a distance function. It has the smallest variance from all variograms.</p></li>
</ul>
<p>We can visualize and compare all variograms simultaneously, and we are sure that the y-axis is the same for every plot. We will use special class of <code class="docutils literal notranslate"><span class="pre">DirectionalVariogram</span></code> to calculate semivariances in all directions at once!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_var</span> <span class="o">=</span> <span class="n">DirectionalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_var</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_23_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_23_0.png" />
</div>
</div>
<p>In your opinion, which semivariogram model is optimal? Should we pick isotropic (omnidirectional) variogram, or one of directional variograms? I’d check how variograms behave at a close distances - in this comparison <strong>NE-SW</strong> shouldn’t be used. But any decision is not definitive, the best what we can do is to perform cross validation on different directional variograms and with different step sizes (bins width).</p>
</section>
<section id="4.-Compare-triangular-vs-elliptical-neighbors-selection-methods">
<h2>4. Compare triangular vs elliptical neighbors selection methods<a class="headerlink" href="#4.-Compare-triangular-vs-elliptical-neighbors-selection-methods" title="Link to this heading">#</a></h2>
<p>Let’s compare calculation times and results from two methods of neighbors interpolation: <code class="docutils literal notranslate"><span class="pre">t</span></code> (<code class="docutils literal notranslate"><span class="pre">triangular</span></code>) and <code class="docutils literal notranslate"><span class="pre">e</span></code> (<code class="docutils literal notranslate"><span class="pre">elliptical</span></code>). We will model two <code class="docutils literal notranslate"><span class="pre">DirectionalVariogram</span></code> objects and count how many seconds it takes, then we will compare output semivariograms.</p>
<p>In the previous release (0.x) <code class="docutils literal notranslate"><span class="pre">triangular</span></code> method was always faster. From the release 1.0 we recommend using elliptical selection, which is heavily optimized!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">perf_counter</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">t0e</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
<span class="n">dir_var_e</span> <span class="o">=</span> <span class="n">DirectionalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>
<span class="n">txe</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time of the semivariance calculations based on elliptical bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">txe</span> <span class="o">-</span> <span class="n">t0e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time of the semivariance calculations based on elliptical bins:
0.2028115200009779
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">t0t</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
<span class="n">dir_var_t</span> <span class="o">=</span> <span class="n">DirectionalVariogram</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">VALUE_COL</span><span class="p">]],</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">SEMI_MAJOR_AXIS_SIZE</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">dir_neighbors_selection_method</span><span class="o">=</span><span class="s1">&#39;t&#39;</span>
<span class="p">)</span>
<span class="n">txt</span> <span class="o">=</span> <span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time of the semivariance calculations based on triangular bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">txt</span> <span class="o">-</span> <span class="n">t0t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time of the semivariance calculations based on triangular bins:
0.9874764849992061
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_var_e</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_28_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_var_t</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_29_0.png" src="../../../_images/usage_tutorials_functional_2-1-directional-semivariogram_29_0.png" />
</div>
</div>
<p>As you see, there are differences between neighbor selection methods. Areas in both methods are not equal, and in some cases one method may catch outliers that will change semivariance for a given lag significantly. Pick one method and use it consistently.</p>
</section>
<section id="Changelog">
<h2>Changelog<a class="headerlink" href="#Changelog" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Changes</p></th>
<th class="head"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2025-04-24</p></td>
<td><p>Tutorial has been adapted to the 1.0 release</p></td>
<td><p>&#64;SimonMolinsky (Szymon Moliński)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1-3-spatial-dependency-index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Spatial Dependency Index</p>
      </div>
    </a>
    <a class="right-next"
       href="2-2-variogram-points-cloud.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Variogram Points Cloud</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1.-Directional-process">1. Directional process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2.-Create-directional-and-isotropic-semivariograms">2. Create directional and isotropic semivariograms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Including-direction-in-experimental-variogram">Including direction in experimental variogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-1:-West-East-direction">Case 1: West-East direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-2:-North-South-direction">Case 2: North-South direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-3:-Northwest-Southeast-direction">Case 3: Northwest-Southeast direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-4:-Northeast-Southwest-direction">Case 4: Northeast-Southwest direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-5:-Isotropic-variogram---no-leading-direction">Case 5: Isotropic variogram - no leading direction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.-Compare-semivariograms">3. Compare semivariograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4.-Compare-triangular-vs-elliptical-neighbors-selection-methods">4. Compare triangular vs elliptical neighbors selection methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Changelog">Changelog</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/usage/tutorials/functional/2-1-directional-semivariogram.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Szymon Moliński.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>