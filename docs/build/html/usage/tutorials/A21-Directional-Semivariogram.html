
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A.2.1 Directional semivariograms &#8212; Pyinterpolate 0.5.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=8e576371"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/tutorials/A21-Directional-Semivariogram';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A.2.2 Variogram Points Cloud" href="A22-Variogram-Points-Cloud.html" />
    <link rel="prev" title="A.1.3 Spatial Dependence Index" href="A13-Spatial-Dependence-Index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pyinterpolate 0.5.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../developer/dev.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../community/community.html">
    Community
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../science/biblio.html">
    Bibliography
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../developer/dev.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../community/community.html">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/biblio.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A11-Semivariogram-Estimation.html">A.1.1 Semivariogram Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="A12-Theoretical-Models.html">A.1.2 Semivariogram models</a></li>
<li class="toctree-l1"><a class="reference internal" href="A13-Spatial-Dependence-Index.html">A.1.3 Spatial Dependence Index</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">A.2.1 Directional semivariograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="A22-Variogram-Points-Cloud.html">A.2.2 Variogram Points Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="A23-Experimental-Variogram-and-Variogram-Point-Cloud-classes.html">Experimental Variogram and Variogram Cloud classes</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="B11-Ordinary-and-Simple-Kriging.html">B.1.1 Ordinary and Simple Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="B12-Kriging-Benchmarking.html">B.1.2 Kriging Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="B13-Outliers-and-Kriging.html">B.1.3 Outliers and Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="B21-Directional-Ordinary-Kriging.html">B.2.1 Directional Ordinary Kriging</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="C11-Blocks-to-Points-with-Ordinary-Kriging.html">C.1.1 Blocks to points Ordinary Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="C12-Semivariogram-Regularization.html">C.1.2 Semivariogram Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="C13-Poisson-Kriging-Centroid-based.html">C.1.3 Poisson Kriging - centroid based approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="C14-Poisson-Kriging-Area-to-Area.html">Poisson Kriging - Area to Area Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="C15-Poisson-Kriging-Area-to-Point.html">Poisson Kriging - Area to Point Kriging</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">A.2.1...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="A.2.1-Directional-semivariograms">
<h1>A.2.1 Directional semivariograms<a class="headerlink" href="#A.2.1-Directional-semivariograms" title="Link to this heading">#</a></h1>
<section id="Table-of-Contents:">
<h2>Table of Contents:<a class="headerlink" href="#Table-of-Contents:" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Read point data,</p></li>
<li><p>Create directional and isotropic semivariograms,</p></li>
<li><p>Compare semivariograms,</p></li>
<li><p>Compare triangular vs elliptical neighbors selection methods.</p></li>
</ol>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will learn about directional semivariograms, how to set the angle of <code class="docutils literal notranslate"><span class="pre">direction</span></code>, and the <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> parameter. We compare two neighbor selection methods: <strong>triangular</strong>, which is fast, and <strong>elliptical</strong>, which is accurate.</p>
<section id="A-directional-process">
<h3>A directional process<a class="headerlink" href="#A-directional-process" title="Link to this heading">#</a></h3>
<p>Not every spatial process may be described by isotropic semivariograms. Sometimes we see a specific trend in one direction (N-S, W-E, or NE-SW, NW-SE). A well-performed analysis includes directions. That’s why we will learn to write code in <code class="docutils literal notranslate"><span class="pre">pyinterpolate</span></code> that retrieves the directional semivariogram.</p>
<p>We use the air pollution data.</p>
<blockquote>
<div><p><strong>Note</strong>: if you are a machine learning enthusiast, it will be easier to understand <strong>direction</strong> as an additional feature to model semivariance.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Experimental variogram</span>
<span class="kn">from</span> <span class="nn">pyinterpolate</span> <span class="kn">import</span> <span class="n">build_experimental_variogram</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="1)-Read-and-show-point-data">
<h2>1) Read and show point data<a class="headerlink" href="#1)-Read-and-show-point-data" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATASET</span> <span class="o">=</span> <span class="s1">&#39;PM2.5&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;samples/directional_variogram_PM25_20220922.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;station_id&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
      <th>x</th>
      <th>PM2.5</th>
    </tr>
    <tr>
      <th>station_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>659</th>
      <td>50.529892</td>
      <td>22.112467</td>
      <td>7.12765</td>
    </tr>
    <tr>
      <th>736</th>
      <td>54.380279</td>
      <td>18.620274</td>
      <td>4.66432</td>
    </tr>
    <tr>
      <th>861</th>
      <td>54.167847</td>
      <td>19.410942</td>
      <td>3.00739</td>
    </tr>
    <tr>
      <th>266</th>
      <td>51.259431</td>
      <td>22.569133</td>
      <td>7.10000</td>
    </tr>
    <tr>
      <th>355</th>
      <td>51.856692</td>
      <td>19.421231</td>
      <td>2.00000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">df2gdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lon_col</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">lat_col</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function transforms DataFrame into GeoDataFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas DataFrame</span>

<span class="sd">    lon_col : str, default = &#39;x&#39;</span>
<span class="sd">        Longitude column name.</span>

<span class="sd">    lat_col : str, default = &#39;y&#39;</span>
<span class="sd">        Latitude column name.</span>

<span class="sd">    epsg : Union[int, str], default = 4326</span>
<span class="sd">        EPSG number of projection.</span>

<span class="sd">    crs : str, default = None</span>
<span class="sd">        Coordinate Reference System of data.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gdf : GeoPandas GeoDataFrame</span>
<span class="sd">        GeoDataFrame with set geometry column (&#39;geometry&#39;), CRS, and all columns from the passed DataFrame.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">lon_col</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">lat_col</span><span class="p">])</span>
    <span class="n">geometry</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;geometry&#39;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gdf</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gds</span> <span class="o">=</span> <span class="n">df2gdf</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">gds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
      <th>x</th>
      <th>PM2.5</th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>station_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>659</th>
      <td>50.529892</td>
      <td>22.112467</td>
      <td>7.12765</td>
      <td>POINT (22.11247 50.52989)</td>
    </tr>
    <tr>
      <th>736</th>
      <td>54.380279</td>
      <td>18.620274</td>
      <td>4.66432</td>
      <td>POINT (18.62027 54.38028)</td>
    </tr>
    <tr>
      <th>861</th>
      <td>54.167847</td>
      <td>19.410942</td>
      <td>3.00739</td>
      <td>POINT (19.41094 54.16785)</td>
    </tr>
    <tr>
      <th>266</th>
      <td>51.259431</td>
      <td>22.569133</td>
      <td>7.10000</td>
      <td>POINT (22.56913 51.25943)</td>
    </tr>
    <tr>
      <th>355</th>
      <td>51.856692</td>
      <td>19.421231</td>
      <td>2.00000</td>
      <td>POINT (19.42123 51.85669)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gds</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
y           False
x           False
PM2.5        True
geometry    False
dtype: bool
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gds</span> <span class="o">=</span> <span class="n">gds</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gds</span> <span class="o">=</span> <span class="n">gds</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">2180</span><span class="p">)</span>
<span class="n">gds</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="n">DATASET</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PM2.5 concentrations in Poland&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;PM2.5 concentrations in Poland&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_9_1.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_9_1.png" />
</div>
</div>
</section>
<section id="2)-Create-the-experimental-semivariogram">
<h2>2) Create the experimental semivariogram<a class="headerlink" href="#2)-Create-the-experimental-semivariogram" title="Link to this heading">#</a></h2>
<p>If we recall the tutorial <code class="docutils literal notranslate"><span class="pre">A.1.1</span> <span class="pre">Semivariogram</span> <span class="pre">Estimation</span></code>, there are three main parameters to set for the <code class="docutils literal notranslate"><span class="pre">build_experimental_variogram()</span></code> function:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input_array</span></code>: <code class="docutils literal notranslate"><span class="pre">numpy</span> <span class="pre">array</span></code> with coordinates and observed values, for example: <code class="docutils literal notranslate"><span class="pre">[[0,</span> <span class="pre">0,</span> <span class="pre">10],</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">20]]</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_size</span></code>: we must divide our analysis area into discrete <strong>lags</strong>. <strong>Lags</strong> are intervals (usually circular) within which we check if the point has a neighbor. For example, if we look into the lag <code class="docutils literal notranslate"><span class="pre">500</span></code>, then we are going to compare one point with other points in a distance <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1000]</span></code> from this point,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_range</span></code>: This parameter represents the possible <strong>maximum range of spatial dependency</strong>. This parameter should be at most half of the extent.</p></li>
</ol>
<p>But that’s not everything! We didn’t use three other parameters:</p>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span></code>: it is a <code class="docutils literal notranslate"><span class="pre">float</span></code> in the range [0, 360]. We set the direction of the semivariogram:</p></li>
</ol>
<ul class="simple">
<li><p>0 or 180: is WE direction,</p></li>
<li><p>90 or 270 is NS direction,</p></li>
<li><p>45 or 225 is NE-SW direction,</p></li>
<li><p>135 or 315 is NW-SE direction.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code>: it is a <code class="docutils literal notranslate"><span class="pre">float</span></code> in the range [0, 1]. If we leave <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> with default <strong>1</strong>, we will always get an isotropic semivariogram. Another edge case is if we set <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> to <strong>0</strong>, then points must be placed on a single line with the beginning in the origin of the coordinate system and the angle given by the y-axis and direction parameter. If tolerance is &gt; 0 and &lt; 1, the bin is selected as an elliptical area with a major axis pointed in the same direction as the line for
0 tolerance.</p></li>
</ol>
<ul class="simple">
<li><p>The major axis size is <code class="docutils literal notranslate"><span class="pre">(tolerance</span> <span class="pre">*</span> <span class="pre">step_size)</span></code>,</p></li>
<li><p>The minor axis size is <code class="docutils literal notranslate"><span class="pre">((1</span> <span class="pre">-</span> <span class="pre">tolerance)</span> <span class="pre">*</span> <span class="pre">step_size)</span></code>,</p></li>
<li><p>The baseline point is at the center of the ellipse.</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: it is <code class="docutils literal notranslate"><span class="pre">str</span></code> with possible values:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">triangle</span></code> for triangular neighbors selection which is fast and recommended for a big dataset,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> or <code class="docutils literal notranslate"><span class="pre">ellipse</span></code> for elliptical neighbors selection which is accurate but slow, recommended for small-size datasets.</p></li>
</ul>
<p>The best idea is to visualize it on a cartesian plane:</p>
<p><img alt="The visualization of directional variogram calculation" src="../../_images/dir_semi_tutorial_graphics.jpg" /></p>
<ul class="simple">
<li><p>The top plane shows a unit circle that is the omnidirectional variogram (black circle). Within it, we see two ellipses: one is bright green, and another is dark green.</p></li>
<li><p>The bottom plane also shows a unit circle and two ellipses: the brighter yellow, and darker purple.</p></li>
<li><p>The long arrows within both circles are radiuses of the omnidirectional variogram or <strong>the semi-major axis</strong> of a directional ellipse. The <code class="docutils literal notranslate"><span class="pre">step_size</span></code> parameter controls its length. The short arrows are present only in the <strong>directional variograms</strong> and are <strong>the semi-minor axes</strong>. The <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> parameter controls their length, and it is always:</p></li>
<li><p>a fraction of <code class="docutils literal notranslate"><span class="pre">step_size</span></code>,</p></li>
<li><p><strong>1</strong>, in this case, a semivariogram is omnidirectional,</p></li>
<li><p>a value very close to 0 (but not 0) - an ellipse falls into the line.</p></li>
<li><p>The good idea is to set <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> to 0.5 and gradually make it smaller or larger (depending on the spatial features).</p></li>
</ul>
<p>We can start the analysis by understanding how our parameters affect the semivariogram bins range. We will set <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> to 0.2 in each case to better visualize the effects of a leading direction.</p>
<section id="Case-1:-W-E-Direction">
<h3>Case 1: W-E Direction<a class="headerlink" href="#Case-1:-W-E-Direction" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BIN_RADIUS</span> <span class="o">=</span> <span class="mi">60000</span>  <span class="c1"># meters</span>
<span class="n">MAX_RANGE</span> <span class="o">=</span> <span class="mi">400000</span>  <span class="c1"># meters</span>
<span class="n">TOLERANCE</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inp_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gds</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                            <span class="n">gds</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                            <span class="n">gds</span><span class="p">[</span><span class="n">DATASET</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">we_variogram</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>

<span class="n">we_variogram</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_16_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_16_0.png" />
</div>
</div>
</section>
<section id="Case-2:-N-S-Direction">
<h3>Case 2: N-S Direction<a class="headerlink" href="#Case-2:-N-S-Direction" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_variogram</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>

<span class="n">ns_variogram</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_18_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_18_0.png" />
</div>
</div>
</section>
<section id="Case-3:-NW-SE-Direction">
<h3>Case 3: NW-SE Direction<a class="headerlink" href="#Case-3:-NW-SE-Direction" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nw_se_variogram</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="mi">135</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>

<span class="n">nw_se_variogram</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_20_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_20_0.png" />
</div>
</div>
</section>
<section id="Case-4:-NE-SW-Direction">
<h3>Case 4: NE-SW Direction<a class="headerlink" href="#Case-4:-NE-SW-Direction" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ne_sw_variogram</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>

<span class="n">ne_sw_variogram</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_22_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_22_0.png" />
</div>
</div>
</section>
<section id="Case-5:-Isotropic-Variogram">
<h3>Case 5: Isotropic Variogram<a class="headerlink" href="#Case-5:-Isotropic-Variogram" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_variogram</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span>
<span class="p">)</span>

<span class="n">iso_variogram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_24_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_24_0.png" />
</div>
</div>
</section>
</section>
<section id="3)-Compare-semivariograms">
<h2>3) Compare semivariograms<a class="headerlink" href="#3)-Compare-semivariograms" title="Link to this heading">#</a></h2>
<p>We have created a set of variograms. What did we observe?</p>
<ul class="simple">
<li><p>The <strong>NE-SW</strong> variogram is very weak at describing a short-range variation (compare it to the map of air pollution from the beginning of the tutorial. Points in this direction are relatively similar).</p></li>
<li><p>The <strong>N-S</strong> variogram works well for a short range.</p></li>
<li><p>The <strong>W-E</strong> variogram catches too much variability, and lags must be longer for this direction.</p></li>
<li><p>The <strong>NW-SE</strong> variogram looks good and shows approximately linear variability change in a distance function. It has the smallest variance from all variograms.</p></li>
</ul>
<p>We can visualize and compare all variograms simultaneously, and we are sure that the y-axis is the same for every plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_lags</span> <span class="o">=</span> <span class="n">iso_variogram</span><span class="o">.</span><span class="n">lags</span>
<span class="n">_ns</span> <span class="o">=</span> <span class="n">ns_variogram</span><span class="o">.</span><span class="n">experimental_semivariances</span>
<span class="n">_we</span> <span class="o">=</span> <span class="n">we_variogram</span><span class="o">.</span><span class="n">experimental_semivariances</span>
<span class="n">_nw_se</span> <span class="o">=</span> <span class="n">nw_se_variogram</span><span class="o">.</span><span class="n">experimental_semivariances</span>
<span class="n">_ne_sw</span> <span class="o">=</span> <span class="n">ne_sw_variogram</span><span class="o">.</span><span class="n">experimental_semivariances</span>
<span class="n">_iso</span> <span class="o">=</span> <span class="n">iso_variogram</span><span class="o">.</span><span class="n">experimental_semivariances</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_iso</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_ns</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#c2a5cf&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_we</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#e7d4e8&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_nw_se</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#5aae61&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_ne_sw</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1b7837&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of experimental semivariance models&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Isotropic&#39;</span><span class="p">,</span>
            <span class="s1">&#39;NS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;WE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;NW-SE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;NE-SW&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Semivariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_26_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_26_0.png" />
</div>
</div>
<p>What do you think about this comparison? Do you agree that the <strong>NW-SE</strong> variogram best fits the data?</p>
</section>
<section id="4)-Bonus:-Compare-calculation-times-and-results">
<h2>4) Bonus: Compare calculation times and results<a class="headerlink" href="#4)-Bonus:-Compare-calculation-times-and-results" title="Link to this heading">#</a></h2>
<p>Let’s compare calculation times and results from two methods of neighbors interpolation: <code class="docutils literal notranslate"><span class="pre">t</span></code> (triangular) and <code class="docutils literal notranslate"><span class="pre">e</span></code> (elliptical). We will follow data in the <strong>NW-SE</strong> direction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0e</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="c1"># Here elliptical</span>

<span class="n">nw_se_variogram_elliptical</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="mi">135</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;e&#39;</span>
<span class="p">)</span>

<span class="n">tfin_e</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0e</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0t</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="c1"># Here triangular</span>

<span class="n">nw_se_variogram_triangular</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span>
    <span class="n">input_array</span><span class="o">=</span><span class="n">inp_arr</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="n">BIN_RADIUS</span><span class="p">,</span>
    <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="mi">135</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">TOLERANCE</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;t&#39;</span>
<span class="p">)</span>

<span class="n">tfin_t</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0t</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;The triangular method is </span><span class="si">{</span><span class="n">tfin_e</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tfin_t</span><span class="si">}</span><span class="s1"> times faster than the elliptical selection.&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The triangular method is 2.7558084695886036 times faster than the elliptical selection.
</pre></div></div>
</div>
<p>For this scenario, the triangular method is 1.5x faster than the elliptical selection. However, this difference will be more significant with more points and point pairs, and triangular selection is 5x faster for big datasets.</p>
<p>Are variograms different? Let’s compare!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_lags</span> <span class="o">=</span> <span class="n">iso_variogram</span><span class="o">.</span><span class="n">lags</span>
<span class="n">_nw_se_ell</span> <span class="o">=</span> <span class="n">nw_se_variogram_elliptical</span><span class="o">.</span><span class="n">experimental_semivariances</span>
<span class="n">_nw_se_tri</span> <span class="o">=</span> <span class="n">nw_se_variogram_triangular</span><span class="o">.</span><span class="n">experimental_semivariances</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_nw_se_ell</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">_nw_se_tri</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of experimental semivariance models for NW-SE direction.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Elliptical selection&#39;</span><span class="p">,</span> <span class="s1">&#39;Triangular selection&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Semivariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A21-Directional-Semivariogram_34_0.png" src="../../_images/usage_tutorials_A21-Directional-Semivariogram_34_0.png" />
</div>
</div>
<p>The general shape is the same, but the variance of a semivariogram from a triangular selection is lower; it is harder to distinguish the covariance between neighboring points and could be dangerously close to the nugget effect. You should consider this (especially) in automatic calculations to avoid strange results or models that are not better than a simple IDW technique.</p>
<p>But semivariogram for the elliptical selection can have different parameters than for the triangular selection. If you choose a different step size and tolerance, the semivariogram’s shape may change and could better describe dissimilarities.</p>
<hr class="docutils" />
</section>
<section id="Where-to-go-from-here?">
<h2>Where to go from here?<a class="headerlink" href="#Where-to-go-from-here?" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A.2.2 Variogram Point Cloud</p></li>
<li><p>A.2.3 Experimental Variogram and Variogram Point Cloud Classes</p></li>
<li><p>B.1.1 Ordinary and Simple Kriging</p></li>
<li><p>B.3.1 Directional Ordinary Kriging</p></li>
</ul>
</section>
<section id="Changelog">
<h2>Changelog<a class="headerlink" href="#Changelog" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Change description</p></th>
<th class="head"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2023-08-21</p></td>
<td><p>The tutorial was refreshed and set along with the 0.5.0 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2023-04-15</p></td>
<td><p>Update: 0.4.1</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2023-03-04</p></td>
<td><p>Removed import for the download air quality dataset</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2022-11-05</p></td>
<td><p>Tutorial updated for the 0.3.5 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2022-10-31</p></td>
<td><p>Bug update: wrong direction of angle from origin, it was clockwise but now it is counterclockwise</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2022-10-21</p></td>
<td><p>Bug update: wrong name of the N-S variogram</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2022-10-17</p></td>
<td><p>Bug update: directions are calculated in a valid way. New feature: added comparison between elliptical and triangular neighbors selection</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2022-09-22</p></td>
<td><p>The first version of tutorial</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
</tbody>
</table>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="A13-Spatial-Dependence-Index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">A.1.3 Spatial Dependence Index</p>
      </div>
    </a>
    <a class="right-next"
       href="A22-Variogram-Points-Cloud.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">A.2.2 Variogram Points Cloud</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Table-of-Contents:">Table of Contents:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#A-directional-process">A directional process</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1)-Read-and-show-point-data">1) Read and show point data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2)-Create-the-experimental-semivariogram">2) Create the experimental semivariogram</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-1:-W-E-Direction">Case 1: W-E Direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-2:-N-S-Direction">Case 2: N-S Direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-3:-NW-SE-Direction">Case 3: NW-SE Direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-4:-NE-SW-Direction">Case 4: NE-SW Direction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Case-5:-Isotropic-Variogram">Case 5: Isotropic Variogram</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3)-Compare-semivariograms">3) Compare semivariograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4)-Bonus:-Compare-calculation-times-and-results">4) Bonus: Compare calculation times and results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Where-to-go-from-here?">Where to go from here?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Changelog">Changelog</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/usage/tutorials/A21-Directional-Semivariogram.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Szymon Moliński.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>