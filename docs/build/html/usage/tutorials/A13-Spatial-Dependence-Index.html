
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A.1.3 Spatial Dependence Index &#8212; Pyinterpolate 0.5.4 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=e1a677a5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/tutorials/A13-Spatial-Dependence-Index';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A.2.1 Directional semivariograms" href="A21-Directional-Semivariogram.html" />
    <link rel="prev" title="A.1.2 Semivariogram models" href="A12-Theoretical-Models.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pyinterpolate 0.5.4 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../developer/dev.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../community/community.html">
    Community
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../science/biblio.html">
    Bibliography
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../developer/dev.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../community/community.html">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/biblio.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A11-Semivariogram-Estimation.html">A.1.1 Semivariogram Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="A12-Theoretical-Models.html">A.1.2 Semivariogram models</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">A.1.3 Spatial Dependence Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="A21-Directional-Semivariogram.html">A.2.1 Directional semivariograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="A22-Variogram-Points-Cloud.html">A.2.2 Variogram Points Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="A23-Experimental-Variogram-and-Variogram-Point-Cloud-classes.html">Experimental Variogram and Variogram Cloud classes</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="B11-Ordinary-and-Simple-Kriging.html">B.1.1 Ordinary and Simple Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="B12-Kriging-Benchmarking.html">B.1.2 Kriging Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="B13-Outliers-and-Kriging.html">B.1.3 Outliers and Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="B21-Directional-Ordinary-Kriging.html">B.2.1 Directional Ordinary Kriging</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="C11-Blocks-to-Points-with-Ordinary-Kriging.html">C.1.1 Blocks to points Ordinary Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="C12-Semivariogram-Regularization.html">C.1.2 Semivariogram Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="C13-Poisson-Kriging-Centroid-based.html">C.1.3 Poisson Kriging - centroid based approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="C14-Poisson-Kriging-Area-to-Area.html">Poisson Kriging - Area to Area Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="C15-Poisson-Kriging-Area-to-Point.html">Poisson Kriging - Area to Point Kriging</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">A.1.3 Spatial Dependence Index</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="A.1.3-Spatial-Dependence-Index">
<h1>A.1.3 Spatial Dependence Index<a class="headerlink" href="#A.1.3-Spatial-Dependence-Index" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>Is dataset worth modeling?</p>
</div></blockquote>
<section id="Table-of-Contents:">
<h2>Table of Contents:<a class="headerlink" href="#Table-of-Contents:" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>What is the spatial dependcy index?</p></li>
<li><p>Why do we use spatial dependency index?</p></li>
<li><p>Example: The comparison of different Spatial Dependence Index over the same extent but different elements.</p></li>
<li><p>API links.</p></li>
</ol>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will learn how to estimate <strong>spatial dependency index</strong>. Algorithm is based on the work:</p>
<p><code class="docutils literal notranslate"><span class="pre">[1]</span> <span class="pre">CAMBARDELLA,</span> <span class="pre">C.A.;</span> <span class="pre">MOORMAN,</span> <span class="pre">T.B.;</span> <span class="pre">PARKIN,</span> <span class="pre">T.B.;</span> <span class="pre">KARLEN,</span> <span class="pre">D.L.;</span> <span class="pre">NOVAK,</span> <span class="pre">J.M.;</span> <span class="pre">TURCO,</span> <span class="pre">R.F.;</span> <span class="pre">KONOPKA,</span> <span class="pre">A.E.</span> <span class="pre">Field-scale</span> <span class="pre">variability</span> <span class="pre">of</span> <span class="pre">soil</span> <span class="pre">properties</span> <span class="pre">in</span> <span class="pre">central</span> <span class="pre">Iowa</span> <span class="pre">soils.</span> <span class="pre">Soil</span> <span class="pre">Science</span> <span class="pre">Society</span> <span class="pre">of</span> <span class="pre">America</span> <span class="pre">Journal,</span> <span class="pre">v.</span> <span class="pre">58,</span> <span class="pre">n.</span> <span class="pre">5,</span> <span class="pre">p.</span> <span class="pre">1501-1511,</span> <span class="pre">1994.</span></code></p>
</section>
<section id="1.-What-is-the-spatial-dependency-index?">
<h2>1. What is the spatial dependency index?<a class="headerlink" href="#1.-What-is-the-spatial-dependency-index?" title="Link to this heading">#</a></h2>
<p>The spatial dependency index (SDI) measures the strength of a spatial process we are modeling. SDI is normalized to the interval between 0 and 1. Therefore, we can transform it into percentages and assign an order of spatial dependency from weak to strong.</p>
<p>The SDI is a ratio of the nugget to the total variance (sill) of a model:</p>
<div class="math notranslate nohighlight">
\[SDI = \frac{nugget}{sill} * 100\]</div>
<p>Whenever we fit a theoretical variogram with the <code class="docutils literal notranslate"><span class="pre">pyinterpolate</span></code> package, SDI is calculated, and we will take advantage of it in the examples. Two values represent SDI:</p>
<ul class="simple">
<li><p><strong>numeric</strong>, a ratio of nugget and sill in percent,</p></li>
<li><p><strong>categorical</strong>, a description of a spatial dependency strength.</p></li>
</ul>
<p>There are four levels of spatial dependency.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Lower Limit (included)</p></th>
<th class="head"><p>Upper Limit (excluded)</p></th>
<th class="head"><p>Strength</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>25</p></td>
<td><p>strong</p></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>75</p></td>
<td><p>moderate</p></td>
</tr>
<tr class="row-even"><td><p>75</p></td>
<td><p>95</p></td>
<td><p>weak</p></td>
</tr>
<tr class="row-odd"><td><p>95</p></td>
<td><p><em>inf</em></p></td>
<td><p>no spatial dependence</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>The lower the ratio, the most substantial spatial dependence</strong>. If the ratio is greater than 75 percent, we should be cautious with spatial modeling because spatial similarities may not explain the process.</p>
</section>
<section id="2.-Why-do-we-use-the-spatial-dependency-index?">
<h2>2. Why do we use the spatial dependency index?<a class="headerlink" href="#2.-Why-do-we-use-the-spatial-dependency-index?" title="Link to this heading">#</a></h2>
<p>In a world where Tobler’s Law can be applied to every spatial phenomenon, we might always use kriging without consideration. We know that spatial dependence exists, and close neighbors are always similar.</p>
<p>This world is not our world! Not every process follows Tobler’s Law. We can find examples sampled over the same area and scale, but their spatial dependence indexes differ. In [1] (SDI in <code class="docutils literal notranslate"><span class="pre">pyinterpolate</span></code> is based on this publication), multiple chemical compounds are sampled from the same field. Every compound has its spatial distribution and variogram. Some soil parameters are not spatially dependent (for example, <em>Mg</em> or <em>Ca</em> that are randomly distributed).</p>
<p>The spatial dependence index level marks the next decision on what to do with the data.</p>
<ul class="simple">
<li><p>Strong: just krige it!</p></li>
<li><p>Moderate: there might be some other thing that explains process variation.</p></li>
<li><p>Weak: the other non-spatial process has more influence on data than spatial similarities.</p></li>
<li><p>No spatial dependence: the process is random, or spatial dependencies cannot explain variance.</p></li>
</ul>
<p><strong>Note</strong>: Be careful because the last two points are red flags, BUT sometimes processes with a low variogram variability at one scale may be explained with spatial relations at a changed scale. A practical example is a comparison of rental apartment prices per night: if you look at the scale of hundreds of kilometers, the spatial dependence may be very weak or none. On the other hand, the spatial similarity between prices of apartments close to each other (up to 10 kilometers, 6 miles) tends to
show a <em>classic variogram curve</em>. The reason is simple: most managers and algorithms use information about the pricing of the closest neighbors, and neighborhood prices are affected by the same external objects or events.</p>
<p>We should look into the spatial dependence index to ensure our path leads us toward meaningful results.</p>
</section>
<section id="Example:-Spatial-Dependence-over-the-same-study-extent-but-for-different-elements">
<h2>Example: Spatial Dependence over the same study extent but for different elements<a class="headerlink" href="#Example:-Spatial-Dependence-over-the-same-study-extent-but-for-different-elements" title="Link to this heading">#</a></h2>
<p>We will compare the spatial dependence index of four elements: cadmium, copper, lead, and zinc. We use the <em>meuse</em> dataset. The dataset comes from:</p>
<p><code class="docutils literal notranslate"><span class="pre">Pebesma,</span> <span class="pre">Edzer.</span> <span class="pre">(2009).</span> <span class="pre">The</span> <span class="pre">meuse</span> <span class="pre">data</span> <span class="pre">set:</span> <span class="pre">a</span> <span class="pre">tutorial</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">gstat</span> <span class="pre">R</span> <span class="pre">package</span> <span class="pre">-&gt;</span> <span class="pre">[link</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">publication](https://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf)</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pyinterpolate</span> <span class="k">as</span> <span class="nn">ptp</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MEUSE_FILE</span> <span class="o">=</span> <span class="s1">&#39;samples/point_data/csv/meuse/meuse.csv&#39;</span>

<span class="c1"># Variogram parameters</span>
<span class="n">STEP_SIZE</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">MAX_RANGE</span> <span class="o">=</span> <span class="mi">1600</span>
<span class="n">ALLOWED_MODELS</span> <span class="o">=</span> <span class="s1">&#39;safe&#39;</span>


<span class="c1"># Elements</span>
<span class="n">ELEMENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cadmium&#39;</span><span class="p">,</span> <span class="s1">&#39;copper&#39;</span><span class="p">,</span> <span class="s1">&#39;zinc&#39;</span><span class="p">,</span> <span class="s1">&#39;lead&#39;</span><span class="p">]</span>
<span class="n">COLS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">COLS</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">MEUSE_FILE</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">COLS</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>cadmium</th>
      <th>copper</th>
      <th>lead</th>
      <th>zinc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>181072</td>
      <td>333611</td>
      <td>11.7</td>
      <td>85</td>
      <td>299</td>
      <td>1022</td>
    </tr>
    <tr>
      <th>1</th>
      <td>181025</td>
      <td>333558</td>
      <td>8.6</td>
      <td>81</td>
      <td>277</td>
      <td>1141</td>
    </tr>
    <tr>
      <th>2</th>
      <td>181165</td>
      <td>333537</td>
      <td>6.5</td>
      <td>68</td>
      <td>199</td>
      <td>640</td>
    </tr>
    <tr>
      <th>3</th>
      <td>181298</td>
      <td>333484</td>
      <td>2.6</td>
      <td>81</td>
      <td>116</td>
      <td>257</td>
    </tr>
    <tr>
      <th>4</th>
      <td>181307</td>
      <td>333330</td>
      <td>2.8</td>
      <td>48</td>
      <td>117</td>
      <td>269</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Data is skewed for every element in the table. Before we start variogram modeling, we must transform it into a distribution close to normality. We will use a logarithmic transform, pass data into an experimental variogram, and then create theoretical models with the <code class="docutils literal notranslate"><span class="pre">autofit()</span></code> method. We will use <em>grid search</em> to find the best possible nugget value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">:</span>
    <span class="c1"># Prepare data</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">element</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Get experimental variogram</span>
    <span class="n">exp_var</span> <span class="o">=</span> <span class="n">ptp</span><span class="o">.</span><span class="n">build_experimental_variogram</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">STEP_SIZE</span><span class="p">,</span> <span class="n">max_range</span><span class="o">=</span><span class="n">MAX_RANGE</span><span class="p">)</span>

    <span class="c1"># Find optimal theoretical model</span>
    <span class="n">optimal_model</span> <span class="o">=</span> <span class="n">ptp</span><span class="o">.</span><span class="n">TheoreticalVariogram</span><span class="p">()</span>
    <span class="n">optimal_model</span><span class="o">.</span><span class="n">autofit</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">exp_var</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">ALLOWED_MODELS</span><span class="p">,</span> <span class="n">max_nugget</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal model for element </span><span class="si">{}</span><span class="s1"> has </span><span class="si">{:.2f}% o</span><span class="s1">f nugget to sill ratio. Spatial Dependence is </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span> <span class="n">optimal_model</span><span class="o">.</span><span class="n">spatial_dependency_ratio</span><span class="p">,</span> <span class="n">optimal_model</span><span class="o">.</span><span class="n">spatial_dependency_strength</span>
    <span class="p">))</span>
    <span class="n">optimal_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">---</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimal model for element cadmium has 36.02% of nugget to sill ratio. Spatial Dependence is moderate.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_1.png" src="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---
Optimal model for element copper has 20.31% of nugget to sill ratio. Spatial Dependence is strong.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_3.png" src="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---
Optimal model for element zinc has 20.08% of nugget to sill ratio. Spatial Dependence is strong.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_5.png" src="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---
Optimal model for element lead has 20.22% of nugget to sill ratio. Spatial Dependence is strong.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_7.png" src="../../_images/usage_tutorials_A13-Spatial-Dependence-Index_9_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---
</pre></div></div>
</div>
<p>The strength of spatial dependence differs mostly between <em>Cadmium</em> and other elements.</p>
</section>
<section id="API">
<h2>API<a class="headerlink" href="#API" title="Link to this heading">#</a></h2>
<p>The spatial dependence index may be calculated directly with the <code class="docutils literal notranslate"><span class="pre">calculate_spatial_dependence_index()</span></code> function that takes two parameters: <code class="docutils literal notranslate"><span class="pre">nugget</span></code> and <code class="docutils literal notranslate"><span class="pre">sill</span></code>. It returns <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> with spatial dependence ratio and spatial dependence strength.</p>
<p>Another way is to calculate <code class="docutils literal notranslate"><span class="pre">TheoreticalVariogram</span></code> with a grid search option for nugget (just leave the <code class="docutils literal notranslate"><span class="pre">nugget</span></code> parameter as <code class="docutils literal notranslate"><span class="pre">None</span></code> and the algorithm will find the optimal nugget value).</p>
<hr class="docutils" />
<p>Where to go from here?</p>
<ul class="simple">
<li><p>A.2.1 Directional Semivariogram</p></li>
<li><p>A.2.2 Variogram Point Cloud</p></li>
<li><p>A.2.3 Experimental Variogram and Variogram Point Cloud Classes</p></li>
<li><p>B.1.1 Ordinary and Simple Kriging</p></li>
</ul>
</section>
<section id="Changelog">
<h2>Changelog<a class="headerlink" href="#Changelog" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Change description</p></th>
<th class="head"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2023-08-19</p></td>
<td><p>The tutorial was refreshed and set along with the 0.5.0 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2023-04-15</p></td>
<td><p>Tutorial debugged and updated to the 0.4.1 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2023-04-08</p></td>
<td><p>The first version of the tutorial</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
</tbody>
</table>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="A12-Theoretical-Models.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">A.1.2 Semivariogram models</p>
      </div>
    </a>
    <a class="right-next"
       href="A21-Directional-Semivariogram.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">A.2.1 Directional semivariograms</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Table-of-Contents:">Table of Contents:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1.-What-is-the-spatial-dependency-index?">1. What is the spatial dependency index?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2.-Why-do-we-use-the-spatial-dependency-index?">2. Why do we use the spatial dependency index?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Example:-Spatial-Dependence-over-the-same-study-extent-but-for-different-elements">Example: Spatial Dependence over the same study extent but for different elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#API">API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Changelog">Changelog</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/usage/tutorials/A13-Spatial-Dependence-Index.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Szymon Moliński.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>