
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A.1.1 Semivariogram Estimation &#8212; Pyinterpolate 0.5.4 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=e1a677a5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/tutorials/A11-Semivariogram-Estimation';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="A.1.2 Semivariogram models" href="A12-Theoretical-Models.html" />
    <link rel="prev" title="Tutorials" href="../tutorials.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Pyinterpolate 0.5.4 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../developer/dev.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../community/community.html">
    Community
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../science/biblio.html">
    Bibliography
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../setup/setup.html">
    Setup
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../developer/dev.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../community/community.html">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../learning_materials.html">
    Learning Materials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../science/biblio.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">A.1.1 Semivariogram Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="A12-Theoretical-Models.html">A.1.2 Semivariogram models</a></li>
<li class="toctree-l1"><a class="reference internal" href="A13-Spatial-Dependence-Index.html">A.1.3 Spatial Dependence Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="A21-Directional-Semivariogram.html">A.2.1 Directional semivariograms</a></li>
<li class="toctree-l1"><a class="reference internal" href="A22-Variogram-Points-Cloud.html">A.2.2 Variogram Points Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="A23-Experimental-Variogram-and-Variogram-Point-Cloud-classes.html">Experimental Variogram and Variogram Cloud classes</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="B11-Ordinary-and-Simple-Kriging.html">B.1.1 Ordinary and Simple Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="B12-Kriging-Benchmarking.html">B.1.2 Kriging Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="B13-Outliers-and-Kriging.html">B.1.3 Outliers and Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="B21-Directional-Ordinary-Kriging.html">B.2.1 Directional Ordinary Kriging</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="C11-Blocks-to-Points-with-Ordinary-Kriging.html">C.1.1 Blocks to points Ordinary Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="C12-Semivariogram-Regularization.html">C.1.2 Semivariogram Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="C13-Poisson-Kriging-Centroid-based.html">C.1.3 Poisson Kriging - centroid based approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="C14-Poisson-Kriging-Area-to-Area.html">Poisson Kriging - Area to Area Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="C15-Poisson-Kriging-Area-to-Point.html">Poisson Kriging - Area to Point Kriging</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">A.1.1 Semivariogram Estimation</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="A.1.1-Semivariogram-Estimation">
<h1>A.1.1 Semivariogram Estimation<a class="headerlink" href="#A.1.1-Semivariogram-Estimation" title="Link to this heading">#</a></h1>
<section id="Table-of-Contents:">
<h2>Table of Contents:<a class="headerlink" href="#Table-of-Contents:" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Read point data</p></li>
<li><p>Create the experimental variogram</p></li>
<li><p>Set manually different semivariogram models</p></li>
<li><p>Set a semivariogram model automatically</p></li>
<li><p>Export model</p></li>
<li><p>Import model</p></li>
</ol>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will learn how to read and prepare data for semivariogram modeling, manually set semivariogram type, and do it automatically. We will compare different semivariogram models by visualizing the outcomes of the models.</p>
<p>Semivariogram modeling is an initial step before we can perform spatial interpolation of unknown values with Kriging. When you complete this tutorial, you may learn how to:</p>
<ul class="simple">
<li><p>perform point Kriging (ordinary and simple),</p></li>
<li><p>regularize semivariogram of areal data.</p></li>
</ul>
<p>We use DEM data which is stored in a file <code class="docutils literal notranslate"><span class="pre">samples/point_data/txt/pl_dem.txt</span></code>.</p>
</section>
<section id="Import-packages-and-modules">
<h2>Import packages and modules<a class="headerlink" href="#Import-packages-and-modules" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># IO - read text</span>
<span class="kn">from</span> <span class="nn">pyinterpolate</span> <span class="kn">import</span> <span class="n">read_txt</span>
<span class="c1"># Experimental variogram</span>
<span class="kn">from</span> <span class="nn">pyinterpolate</span> <span class="kn">import</span> <span class="n">build_experimental_variogram</span>
<span class="c1"># Theoretical Variogram</span>
<span class="kn">from</span> <span class="nn">pyinterpolate</span> <span class="kn">import</span> <span class="n">TheoreticalVariogram</span><span class="p">,</span> <span class="n">build_theoretical_variogram</span>
</pre></div>
</div>
</div>
</section>
<section id="1)-Read-point-data">
<h2>1) Read point data<a class="headerlink" href="#1)-Read-point-data" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATA</span> <span class="o">=</span> <span class="s1">&#39;samples/point_data/txt/pl_dem_epsg2180.txt&#39;</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">read_txt</span><span class="p">(</span><span class="n">DATA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look into a first few lines of data</span>

<span class="n">dem</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[2.55032701e+05, 5.47047700e+05, 6.29624100e+01],
       [2.54975796e+05, 5.45920408e+05, 2.03861294e+01],
       [2.54751735e+05, 5.41480271e+05, 4.03093376e+01],
       [2.54682103e+05, 5.40099921e+05, 2.19432678e+01],
       [2.54521994e+05, 5.36925123e+05, 5.15251350e+01]])
</pre></div></div>
</div>
</section>
<section id="2)-Create-the-experimental-variogram">
<h2>2) Create the experimental variogram<a class="headerlink" href="#2)-Create-the-experimental-variogram" title="Link to this heading">#</a></h2>
<p>Checking spatial correlation in our dataset is the first required step. We use variograms - plots of the dissimilarity between point pairs (y-axis) along a rising distance (x-axis). There are two “types” of variograms.</p>
<ul class="simple">
<li><p><strong>Experimental (semi)variogram</strong>: directly showing differences between point pairs at specific distances - lags. It could be very messy. We use it to check if there is a spatial correlation.</p></li>
<li><p><strong>Theoretical (semi)variogram</strong>: is a particular function applied to the experimental variogram. We fit a function from a pre-defined set to experimental semivariogram points and choose the model with the lowest error possible. We have a few models to try and only three <em>hyperparameters</em> for controlling their behavior.</p></li>
</ul>
<p>We start our analysis by setting up the experimental model. We use the <code class="docutils literal notranslate"><span class="pre">build_experimental_variogram()</span></code> function, which creates for us an <code class="docutils literal notranslate"><span class="pre">ExperimentalVariogram</span></code> object. We pass to this function three parameters:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input_array</span></code>: <code class="docutils literal notranslate"><span class="pre">numpy</span> <span class="pre">array</span></code> with coordinates and observed values, for example: <code class="docutils literal notranslate"><span class="pre">[[0,</span> <span class="pre">0,</span> <span class="pre">10],</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">20]]</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_size</span></code>: we must divide our area of analysis into discrete <strong>lags</strong>. <strong>The lags</strong> are intervals where we check if the point has a neighbor. For example, if we look into the lag <code class="docutils literal notranslate"><span class="pre">500</span></code>, then we are going to compare one point with other points in a distance <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1000]</span></code> from this point,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_range</span></code>: this parameter represents the possible <strong>maximum range of spatial dependency</strong>. This parameter should be at most half of the area extent.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create experimental semivariogram</span>

<span class="n">step_radius</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># meters</span>
<span class="n">max_range</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># meters</span>

<span class="n">experimental_variogram</span> <span class="o">=</span> <span class="n">build_experimental_variogram</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">dem</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="n">step_radius</span><span class="p">,</span> <span class="n">max_range</span><span class="o">=</span><span class="n">max_range</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># What is a type of experimental variogram?</span>

<span class="nb">type</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyinterpolate.variogram.empirical.experimental_variogram.ExperimentalVariogram
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ExperimentalVariogram</span></code> object represents all information that we could estimate from our measurements:</p>
<ul class="simple">
<li><p><strong>semivariance</strong>: dissimilarity over a distance,</p></li>
<li><p><strong>covariance</strong>: similarity over a distance,</p></li>
<li><p><strong>variance</strong>: non-spatial variance of all points.</p></li>
</ul>
<p>The class has two useful methods:</p>
<ol class="arabic simple">
<li><p>We can print object statistics with the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function,</p></li>
<li><p>or we can plot <em>semivariance</em>, <em>covariance</em>, and <em>variance</em> and check how they behave with the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method.</p></li>
</ol>
<p>Let’s check both!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+--------+--------------------+---------------------+--------------------+
|  lag   |    semivariance    |      covariance     |    var_cov_diff    |
+--------+--------------------+---------------------+--------------------+
| 500.0  | 14.716058620972868 |  480.99904783812127 | 8.821278469608444  |
| 1000.0 | 34.85400868491261  |  464.2196256667607  | 25.600700640969023 |
| 1500.0 | 57.712760007769795 |  433.73651582698574 | 56.08381048074398  |
| 2000.0 | 82.49483539006093  |  403.5799288984297  | 86.24039740929999  |
| 2500.0 | 111.4449493651956  |  364.9336781724029  | 124.88664813532682 |
| 3000.0 | 143.4007980025356  |  325.6459001433955  | 164.1744261643342  |
| 3500.0 | 175.10704725708965 |  284.4093681493841  | 205.41095815834564 |
| 4000.0 | 209.3522343651705  |  245.59671700665646 | 244.22360930107325 |
| 4500.0 | 244.46785072173265 |  204.4305639103993  | 285.3897623973304  |
| 5000.0 | 281.0897575749926  |  159.61259251127132 | 330.2077337964584  |
| 5500.0 | 315.67549229122216 |  118.99201963546533 | 370.8283066722644  |
| 6000.0 | 349.5718260502048  |  81.90206675127321  | 407.9182595564565  |
| 6500.0 | 381.7274369750636  |  47.01829083567338  | 442.80203547205633 |
| 7000.0 | 413.81104972218697 |  15.768848642349267 | 474.05147766538045 |
| 7500.0 |  439.311684307325  |  -9.119116076399862 | 498.93944238412956 |
| 8000.0 | 461.6911951584344  | -29.173423730506535 | 518.9937500382363  |
| 8500.0 | 482.51366131979273 |  -44.75615663700621 |  534.576482944736  |
| 9000.0 | 501.63014408854025 | -58.013038178981994 | 547.8333644867117  |
| 9500.0 | 522.2111025684128  |  -72.92100663867586 | 562.7413329464056  |
+--------+--------------------+---------------------+--------------------+
</pre></div></div>
</div>
<ul class="simple">
<li><p><strong>Lag</strong> is a column with the lag center,</p></li>
<li><p><strong>semivariance</strong> is a column with a dissimilarity metric,</p></li>
<li><p><strong>covariance</strong> is a column with a similarity metric,</p></li>
<li><p><strong>var_cov_diff</strong> is a difference between the variance and the covariance; ideally, it should equal the semivariance. But it is possible only if a spatial process is second-order stationary. It is a rare situation in real-world applications. Usually, this value is very close to the semivariance.</p></li>
</ul>
<p>We can plot semivariance and covariance to understand their relation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">experimental_variogram</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_semivariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_covariance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_13_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_13_0.png" />
</div>
</div>
<p>Our plot shows three objects:</p>
<ol class="arabic simple">
<li><p><strong>Circles</strong> represent <em>semivariance</em>,</p></li>
<li><p><strong>Plus signs</strong> represent <em>covariance</em>,</p></li>
<li><p><strong>The dashed line</strong> is a <em>variance</em>.</p></li>
</ol>
<p>We see here that semivariance and covariance are mirrored. What does it mean? It is normal behavior, and we should expect it - semivariance and covariance have symmetrical trends (they differ in a sign). We can read it as:</p>
<ul class="simple">
<li><p>with <strong>semivariance</strong>, the dissimilarity between point pairs over a distance increases,</p></li>
<li><p><strong>covariance</strong> shows that the similarity between point pairs over a distance decreases.</p></li>
</ul>
<p>In the best-case scenario (data is stationary, e.g., mean and variance don’t change with a distance), variance and covariance should be equal to semivariance. That’s why our <code class="docutils literal notranslate"><span class="pre">ExperimentalVariogram</span></code> object prints the difference between those two. We can quickly check if the process we measure is stationary.</p>
<p>With the experimental variogram, we can create a theoretical model of semivariance.</p>
</section>
<section id="3.-Set-manually-different-semivariogram-models">
<h2>3. Set manually different semivariogram models<a class="headerlink" href="#3.-Set-manually-different-semivariogram-models" title="Link to this heading">#</a></h2>
<p>With an experimental variogram, we can start modeling theoretical function that optimally describes observed data. Our role is to choose the modeling function and to set three hyperparameters: nugget, sill, and range. You can read more about semivariogram models here: <a class="reference external" href="https://ml-gis-service.com/index.php/2022/04/01/geostatistics-theoretical-variogram-models/">Geostatistics: Theoretical Variogram Models</a>.</p>
<p>Semivariogram has three basic properties:</p>
<ul class="simple">
<li><p><strong>nugget</strong>: the initial value at a zero distance. In most cases, it is zero, but sometimes it represents a bias in observations.</p></li>
<li><p><strong>sill</strong>: a distance where the semivariogram flattens and reaches approximately 95% of dissimilarity. Sometimes we cannot find a sill; for example, if differences grow exponentially, but in <code class="docutils literal notranslate"><span class="pre">pyinterpolate</span></code> it is usually set close to the variance of data,</p></li>
<li><p><strong>range</strong>: is a distance where a variogram reaches its sill. Larger distances are negligible for interpolation.</p></li>
</ul>
<p>We are not forced to know all of them at the beginning. The package may easily derive them all with the class <code class="docutils literal notranslate"><span class="pre">TheoriticalVariogram</span></code> <code class="docutils literal notranslate"><span class="pre">autofit()</span></code> method.</p>
<p>We can create a theoretical model in two ways:</p>
<ol class="arabic simple">
<li><p>Manually, with the <code class="docutils literal notranslate"><span class="pre">build_theoretical_variogram()</span></code> function,</p></li>
<li><p>Semi-automatically, but here’s the catch: we must create a <code class="docutils literal notranslate"><span class="pre">TheoreticalVariogram</span></code> object first, and in the second step, we may use the <code class="docutils literal notranslate"><span class="pre">.autofit()</span></code> method. Why is that? The reason is simple - if we want to fit a semivariogram automatically, the algorithm (or creator) assumes we know what we are doing. And with knowledge, we can control multiple parameters of the class.</p></li>
</ol>
<p>We start from the <code class="docutils literal notranslate"><span class="pre">build_theoretical_variogram()</span></code> function and look into different models fitted to our data.</p>
<section id="Models">
<h3>Models<a class="headerlink" href="#Models" title="Link to this heading">#</a></h3>
<p>We can choose from a set of predefined models:</p>
<ul class="simple">
<li><p>circular,</p></li>
<li><p>cubic,</p></li>
<li><p>exponential,</p></li>
<li><p>gaussian,</p></li>
<li><p>linear,</p></li>
<li><p>power,</p></li>
<li><p>spherical.</p></li>
</ul>
<p>We will set the following:</p>
<ul class="simple">
<li><p><strong>sill</strong> to the experimental variogram variance,</p></li>
<li><p><strong>nugget</strong> to zero,</p></li>
<li><p><strong>range</strong> to 8000 (we see in the experimental variogram plot that the semivariance <em>flattens</em> around this range, and it becomes close to the variance).</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sill</span> <span class="o">=</span> <span class="n">experimental_variogram</span><span class="o">.</span><span class="n">variance</span>
<span class="n">nugget</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">var_range</span> <span class="o">=</span> <span class="mi">8000</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># circular</span>

<span class="n">circular_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                             <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;circular&#39;</span><span class="p">,</span>
                                             <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                             <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                             <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">circular_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Circular model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: -52.60629816538764
* Mean RMSE: 63.00280857591535
* Error-lag weighting method: None


+--------+--------------------+--------------------+---------------------+
|  lag   |    theoretical     |    experimental    |     bias (y-y&#39;)     |
+--------+--------------------+--------------------+---------------------+
| 500.0  | 38.953271455641215 | 14.716058620972868 | -24.237212834668348 |
| 1000.0 | 77.75383379923626  | 34.85400868491261  | -42.899825114323654 |
| 1500.0 | 116.24715805742842 | 57.712760007769795 |  -58.53439804965863 |
| 2000.0 | 154.2749647378938  | 82.49483539006093  |  -71.78012934783288 |
| 2500.0 | 191.6730553536057  | 111.4449493651956  |  -80.22810598841009 |
| 3000.0 | 228.26874220429437 | 143.4007980025356  |  -84.86794420175877 |
| 3500.0 | 263.87764398483665 | 175.10704725708965 |   -88.770596727747  |
| 4000.0 | 298.29949183176774 | 209.3522343651705  |  -88.94725746659725 |
| 4500.0 | 331.3123650670836  | 244.46785072173265 |  -86.84451434535094 |
| 5000.0 | 362.66434202230323 | 281.0897575749926  |  -81.57458444731066 |
| 5500.0 | 392.0606537618678  | 315.67549229122216 |  -76.38516147064564 |
| 6000.0 | 419.14238179486523 | 349.5718260502048  |  -69.57055574466045 |
| 6500.0 | 443.44740428898785 | 381.7274369750636  |  -61.71996731392426 |
| 7000.0 | 464.3273586391969  | 413.81104972218697 |  -50.51630891700995 |
| 7500.0 | 480.71958538405306 |  439.311684307325  |  -41.40790107672808 |
| 8000.0 | 489.8203263077297  | 461.6911951584344  |  -28.12913114929529 |
| 8500.0 | 489.8203263077297  | 482.51366131979273 |  -7.306664987936983 |
| 9000.0 | 489.8203263077297  | 501.63014408854025 |  11.809817780810533 |
| 9500.0 | 489.8203263077297  | 522.2111025684128  |  32.39077626068308  |
+--------+--------------------+--------------------+---------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circular_model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">experimental</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_20_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_20_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cubic</span>

<span class="n">cubic_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                          <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span>
                                          <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                          <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                          <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cubic_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Cubic model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: -77.44307814715333
* Mean RMSE: 100.93081804872125
* Error-lag weighting method: None


+--------+--------------------+--------------------+---------------------+
|  lag   |    theoretical     |    experimental    |     bias (y-y&#39;)     |
+--------+--------------------+--------------------+---------------------+
| 500.0  | 12.34878902539015  | 14.716058620972868 |  2.3672695955827177 |
| 1000.0 | 45.255288629599086 | 34.85400868491261  | -10.401279944686479 |
| 1500.0 | 92.68405535286398  | 57.712760007769795 | -34.971295345094184 |
| 2000.0 | 148.9805383955685  | 82.49483539006093  |  -66.48570300550756 |
| 2500.0 | 209.04428231682044 | 111.4449493651956  |  -97.59933295162485 |
| 3000.0 | 268.48143737523486 | 143.4007980025356  | -125.08063937269927 |
| 3500.0 | 323.7296800593239  | 175.10704725708965 | -148.62263280223428 |
| 4000.0 | 372.1486463548962  | 209.3522343651705  |  -162.7964119897257 |
| 4500.0 | 412.06898029686596 | 244.46785072173265 |  -167.6011295751333 |
| 5000.0 | 442.79310035287546 | 281.0897575749926  | -161.70334277788288 |
| 5500.0 | 464.5407861861308  | 315.67549229122216 | -148.86529389490863 |
| 6000.0 | 478.33268834485466 | 349.5718260502048  | -128.76086229464988 |
| 6500.0 | 485.8048634257556  | 381.7274369750636  | -104.07742645069203 |
| 7000.0 |  488.947437258918  | 413.81104972218697 |  -75.13638753673104 |
| 7500.0 | 489.7604986615125  |  439.311684307325  | -50.448814354187505 |
| 8000.0 | 489.8203263077297  | 461.6911951584344  |  -28.12913114929529 |
| 8500.0 | 489.8203263077297  | 482.51366131979273 |  -7.306664987936983 |
| 9000.0 | 489.8203263077297  | 501.63014408854025 |  11.809817780810533 |
| 9500.0 | 489.8203263077297  | 522.2111025684128  |  32.39077626068308  |
+--------+--------------------+--------------------+---------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cubic_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_23_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_23_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exponential model</span>

<span class="n">exponential_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                                <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;exponential&#39;</span><span class="p">,</span>
                                                <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                                <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                                <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exponential_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Exponential model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: 62.87847144716388
* Mean RMSE: 97.41020702761479
* Error-lag weighting method: None


+--------+--------------------+--------------------+---------------------+
|  lag   |    theoretical     |    experimental    |     bias (y-y&#39;)     |
+--------+--------------------+--------------------+---------------------+
| 500.0  | 29.676713342689204 | 14.716058620972868 | -14.960654721716336 |
| 1000.0 | 57.555405518182404 | 34.85400868491261  | -22.701396833269797 |
| 1500.0 | 83.74501312199658  | 57.712760007769795 | -26.032253114226783 |
| 2000.0 | 108.34787261497875 | 82.49483539006093  | -25.853037224917827 |
| 2500.0 | 131.46012020525072 | 111.4449493651956  |  -20.01517084005512 |
| 3000.0 | 153.17206750253146 | 143.4007980025356  |  -9.771269499995867 |
| 3500.0 | 173.56855441271478 | 175.10704725708965 |  1.538492844374872  |
| 4000.0 | 192.72928065164504 | 209.3522343651705  |  16.622953713525447 |
| 4500.0 | 210.72911717348904 | 244.46785072173265 |   33.7387335482436  |
| 5000.0 | 227.63839873061636 | 281.0897575749926  |  53.451358844376216 |
| 5500.0 | 243.5231987081728  | 315.67549229122216 |  72.15229358304936  |
| 6000.0 | 258.44558730726845 | 349.5718260502048  |  91.12623874293632  |
| 6500.0 | 272.4638740856379  | 381.7274369750636  |  109.26356288942571 |
| 7000.0 | 285.63283580350344 | 413.81104972218697 |  128.17821391868353 |
| 7500.0 |  298.003930464957  |  439.311684307325  |  141.30775384236796 |
| 8000.0 | 309.6254983912286  | 461.6911951584344  |  152.06569676720585 |
| 8500.0 | 320.54295111154215 | 482.51366131979273 |  161.97071020825058 |
| 9000.0 | 330.79894880965327 | 501.63014408854025 |  170.83119527888698 |
| 9500.0 | 340.4335670194438  | 522.2111025684128  |   181.777535548969  |
+--------+--------------------+--------------------+---------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exponential_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_25_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gaussian model</span>

<span class="n">gaussian_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                             <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
                                             <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                             <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                             <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gaussian_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Gaussian model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: 106.76795548020137
* Mean RMSE: 116.3487709038113
* Error-lag weighting method: None


+--------+--------------------+--------------------+--------------------+
|  lag   |    theoretical     |    experimental    |    bias (y-y&#39;)     |
+--------+--------------------+--------------------+--------------------+
| 500.0  | 1.9096284783003161 | 14.716058620972868 | 12.806430142672552 |
| 1000.0 | 7.593960284943274  | 34.85400868491261  | 27.26004839996933  |
| 1500.0 | 16.92106251490172  | 57.712760007769795 | 40.791697492868074 |
| 2000.0 | 29.676713342689204 | 82.49483539006093  | 52.81812204737172  |
| 2500.0 | 45.57258050587133  | 111.4449493651956  | 65.87236885932427  |
| 3000.0 | 64.25705194799532  | 143.4007980025356  | 79.14374605454027  |
| 3500.0 | 85.32815073541408  | 175.10704725708965 | 89.77889652167556  |
| 4000.0 | 108.34787261497875 | 209.3522343651705  | 101.00436175019173 |
| 4500.0 | 132.85723424545685 | 244.46785072173265 | 111.6106164762758  |
| 5000.0 | 158.39131498993746 | 281.0897575749926  | 122.69844258505512 |
| 5500.0 | 184.49361349105533 | 315.67549229122216 | 131.18187880016683 |
| 6000.0 | 210.72911717348904 | 349.5718260502048  | 138.84270887671573 |
| 6500.0 | 236.69559082440182 | 381.7274369750636  | 145.03184615066178 |
| 7000.0 | 262.0327201487193  | 413.81104972218697 | 151.77832957346766 |
| 7500.0 | 286.42888738780334 |  439.311684307325  | 152.88279691952164 |
| 8000.0 | 309.6254983912286  | 461.6911951584344  | 152.06569676720585 |
| 8500.0 | 331.41891440687124 | 482.51366131979273 | 151.0947469129215  |
| 9000.0 | 351.66015926974364 | 501.63014408854025 | 149.9699848187966  |
| 9500.0 | 370.2526675939889  | 522.2111025684128  | 151.95843497442388 |
+--------+--------------------+--------------------+--------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaussian_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_27_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_27_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Linear model</span>

<span class="n">linear_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                           <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                           <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                           <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                           <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linear_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Linear model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: -21.58683474038296
* Mean RMSE: 28.218692107535404
* Error-lag weighting method: None


+--------+--------------------+--------------------+---------------------+
|  lag   |    theoretical     |    experimental    |     bias (y-y&#39;)     |
+--------+--------------------+--------------------+---------------------+
| 500.0  | 30.613770394233107 | 14.716058620972868 | -15.897711773260239 |
| 1000.0 | 61.227540788466214 | 34.85400868491261  | -26.373532103553607 |
| 1500.0 | 91.84131118269931  | 57.712760007769795 |  -34.12855117492952 |
| 2000.0 | 122.45508157693243 | 82.49483539006093  |  -39.9602461868715  |
| 2500.0 | 153.06885197116554 | 111.4449493651956  | -41.623902605969946 |
| 3000.0 | 183.68262236539863 | 143.4007980025356  | -40.281824362863034 |
| 3500.0 | 214.29639275963174 | 175.10704725708965 | -39.189345502542096 |
| 4000.0 | 244.91016315386486 | 209.3522343651705  |  -35.55792878869437 |
| 4500.0 | 275.52393354809794 | 244.46785072173265 | -31.056082826365298 |
| 5000.0 | 306.1377039423311  | 281.0897575749926  |  -25.04794636733851 |
| 5500.0 | 336.7514743365642  | 315.67549229122216 | -21.075982045342016 |
| 6000.0 | 367.36524473079726 | 349.5718260502048  |  -17.79341868059248 |
| 6500.0 | 397.9790151250304  | 381.7274369750636  | -16.251578149966804 |
| 7000.0 | 428.5927855192635  | 413.81104972218697 | -14.781735797076522 |
| 7500.0 | 459.20655591349663 |  439.311684307325  | -19.894871606171648 |
| 8000.0 | 489.8203263077297  | 461.6911951584344  |  -28.12913114929529 |
| 8500.0 | 489.8203263077297  | 482.51366131979273 |  -7.306664987936983 |
| 9000.0 | 489.8203263077297  | 501.63014408854025 |  11.809817780810533 |
| 9500.0 | 489.8203263077297  | 522.2111025684128  |  32.39077626068308  |
+--------+--------------------+--------------------+---------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_29_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_29_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Power model</span>

<span class="n">power_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                          <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;power&#39;</span><span class="p">,</span>
                                          <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                          <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                          <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">power_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Power model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: 46.89133587829636
* Mean RMSE: 58.334699200244835
* Error-lag weighting method: None


+--------+--------------------+--------------------+--------------------+
|  lag   |    theoretical     |    experimental    |    bias (y-y&#39;)     |
+--------+--------------------+--------------------+--------------------+
| 500.0  | 1.9133606496395692 | 14.716058620972868 | 12.802697971333298 |
| 1000.0 | 7.653442598558277  | 34.85400868491261  | 27.20056608635433  |
| 1500.0 | 17.22024584675612  | 57.712760007769795 | 40.49251416101367  |
| 2000.0 | 30.613770394233107 | 82.49483539006093  | 51.88106499582782  |
| 2500.0 | 47.83401624098923  | 111.4449493651956  | 63.61093312420637  |
| 3000.0 | 68.88098338702449  | 143.4007980025356  | 74.51981461551111  |
| 3500.0 | 93.75467183233889  | 175.10704725708965 | 81.35237542475076  |
| 4000.0 | 122.45508157693243 | 209.3522343651705  | 86.89715278823806  |
| 4500.0 | 154.98221262080511 | 244.46785072173265 | 89.48563810092753  |
| 5000.0 | 191.33606496395691 | 281.0897575749926  | 89.75369261103566  |
| 5500.0 | 231.5166386063879  | 315.67549229122216 | 84.15885368483427  |
| 6000.0 | 275.52393354809794 | 349.5718260502048  | 74.04789250210683  |
| 6500.0 | 323.3579497890872  | 381.7274369750636  | 58.369487185976425 |
| 7000.0 | 375.01868732935554 | 413.81104972218697 | 38.79236239283142  |
| 7500.0 | 430.50614616890306 |  439.311684307325  | 8.805538138421923  |
| 8000.0 | 489.8203263077297  | 461.6911951584344  | -28.12913114929529 |
| 8500.0 | 489.8203263077297  | 482.51366131979273 | -7.306664987936983 |
| 9000.0 | 489.8203263077297  | 501.63014408854025 | 11.809817780810533 |
| 9500.0 | 489.8203263077297  | 522.2111025684128  | 32.39077626068308  |
+--------+--------------------+--------------------+--------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_31_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_31_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spherical model</span>

<span class="n">spherical_model</span> <span class="o">=</span> <span class="n">build_theoretical_variogram</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
                                              <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;spherical&#39;</span><span class="p">,</span>
                                              <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">,</span>
                                              <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
                                              <span class="n">nugget</span><span class="o">=</span><span class="n">nugget</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">spherical_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Spherical model
* Nugget: 0
* Sill: 489.8203263077297
* Range: 8000
* Spatial Dependency Strength is Unknown
* Mean Bias: -72.94546270439245
* Mean RMSE: 87.44243944688779
* Error-lag weighting method: None


+--------+--------------------+--------------------+---------------------+
|  lag   |    theoretical     |    experimental    |     bias (y-y&#39;)     |
+--------+--------------------+--------------------+---------------------+
| 500.0  | 45.86086307104843  | 14.716058620972868 |  -31.14480445007556 |
| 1000.0 | 91.36297102028944  | 34.85400868491261  |  -56.50896233537683 |
| 1500.0 | 136.1475687259156  | 57.712760007769795 |  -78.4348087181458  |
| 2000.0 | 179.85590106611951 | 82.49483539006093  |  -97.36106567605859 |
| 2500.0 | 222.12921291909373 | 111.4449493651956  | -110.68426355389813 |
| 3000.0 | 262.6087491630309  | 143.4007980025356  |  -119.2079511604953 |
| 3500.0 | 300.9357546761235  | 175.10704725708965 | -125.82870741903386 |
| 4000.0 | 336.7514743365642  | 209.3522343651705  | -127.39923997139368 |
| 4500.0 | 369.69715302254554 | 244.46785072173265 | -125.22930230081289 |
| 5000.0 | 399.4140356122601  | 281.0897575749926  |  -118.3242780372675 |
| 5500.0 | 425.54336698390046 | 315.67549229122216 |  -109.8678746926783 |
| 6000.0 | 447.7263920156592  | 349.5718260502048  |  -98.15456596545442 |
| 6500.0 | 465.6043555857289  | 381.7274369750636  |  -83.87691861066531 |
| 7000.0 | 478.8185025723022  | 413.81104972218697 |  -65.00745285011521 |
| 7500.0 | 487.0100778535716  |  439.311684307325  |  -47.69839354624662 |
| 8000.0 | 489.8203263077297  | 461.6911951584344  |  -28.12913114929529 |
| 8500.0 | 489.8203263077297  | 482.51366131979273 |  -7.306664987936983 |
| 9000.0 | 489.8203263077297  | 501.63014408854025 |  11.809817780810533 |
| 9500.0 | 489.8203263077297  | 522.2111025684128  |  32.39077626068308  |
+--------+--------------------+--------------------+---------------------+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spherical_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_33_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_33_0.png" />
</div>
</div>
<p>A quick look into plots, and we can bet that the best model is <strong>linear</strong>. We can read each table printed with the <code class="docutils literal notranslate"><span class="pre">print()</span></code> method, but instead, we will read <em>Root Mean Squared Error</em> of each model and select the model with the lowest value of RMSE.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">circular_model</span><span class="p">,</span> <span class="n">cubic_model</span><span class="p">,</span> <span class="n">exponential_model</span><span class="p">,</span> <span class="n">gaussian_model</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">power_model</span><span class="p">,</span> <span class="n">spherical_model</span>
<span class="p">]</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
<span class="n">chosen_model</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">_model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>

    <span class="c1"># Get attrs</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="n">_model</span><span class="o">.</span><span class="n">name</span>
    <span class="n">model_rmse</span> <span class="o">=</span> <span class="n">_model</span><span class="o">.</span><span class="n">rmse</span>

    <span class="c1"># Check error</span>
    <span class="k">if</span> <span class="n">model_rmse</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">model_rmse</span>
        <span class="n">chosen_model</span> <span class="o">=</span> <span class="n">model_name</span>

    <span class="c1"># Print status</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Model: </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">, RMSE: </span><span class="si">{</span><span class="n">model_rmse</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;The best model is </span><span class="si">{</span><span class="n">chosen_model</span><span class="si">}</span><span class="s1"> with RMSE </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: circular, RMSE: 63.00280857591535
Model: cubic, RMSE: 100.93081804872125
Model: exponential, RMSE: 97.41020702761479
Model: gaussian, RMSE: 116.3487709038113
Model: linear, RMSE: 28.218692107535404
Model: power, RMSE: 58.334699200244835
Model: spherical, RMSE: 87.44243944688779
The best model is linear with RMSE 28.218692107535404
</pre></div></div>
</div>
</section>
</section>
<section id="4)-Set-automatically-semivariogram-model">
<h2>4) Set automatically semivariogram model<a class="headerlink" href="#4)-Set-automatically-semivariogram-model" title="Link to this heading">#</a></h2>
<p>We can find the optimal semivariogram model automatically, but we can’t do it with the <code class="docutils literal notranslate"><span class="pre">build_theoretical_variogram()</span></code> function. Instead, we use the <code class="docutils literal notranslate"><span class="pre">TheoreticalVariogram</span></code> class. Manual initialization allows us to find the best set of hyperparameters automatically.</p>
<p>This process has two steps:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">TheoreticalVariogram</span></code> class object initialization.</p></li>
<li><p>Fitting the best model and finding the optimal set of parameters with the <code class="docutils literal notranslate"><span class="pre">.autofit()</span></code> method.</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">autofit()</span></code> method takes multiple parameters. The most important for us are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">experimental_variogram</span></code> - the experimental variogram object (<code class="docutils literal notranslate"><span class="pre">ExperimentalVariogram</span></code> type),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model_name</span></code> or <code class="docutils literal notranslate"><span class="pre">model_types</span></code> - the first argument is a name of the model. The second is a list with names to test - if you pass it, then algorithm will check every model from this list. Basic <code class="docutils literal notranslate"><span class="pre">model_name</span></code> parameters are:</p>
<ul>
<li><p>circular,</p></li>
<li><p>cubic,</p></li>
<li><p>exponential,</p></li>
<li><p>gaussian,</p></li>
<li><p>linear,</p></li>
<li><p>power,</p></li>
<li><p>spherical,</p></li>
<li><ol class="loweralpha simple" start="19">
<li><p>all: checks all available model types,</p></li>
</ol>
</li>
<li><ol class="loweralpha simple" start="19">
<li><p>safe: check linear, spherical, and power models.</p></li>
</ol>
</li>
</ul>
</li>
</ul>
<p>If you want to test different set of models instead then use <code class="docutils literal notranslate"><span class="pre">model_types</span></code> with list of models, as for example: <code class="docutils literal notranslate"><span class="pre">['circular',</span> <span class="pre">'power']</span></code>. You may choose any model excluding <code class="docutils literal notranslate"><span class="pre">all</span></code> and <code class="docutils literal notranslate"><span class="pre">safe</span></code> keywords which refer to multiple models.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nugget</span></code> - nugget (bias) of a variogram. If given, then the <em>nugget</em> is fixed to this value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_nugget</span></code> - <strong>default = 0.0</strong> - the minimal fraction of the variance at a distance 0 to search for the optimal nugget,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_nugget</span></code> - <strong>default = 0.5</strong> - the maximum fraction of the variance at a distance 0 to search for the optimal nugget,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number_of_nuggets</span></code> - <strong>default = 16</strong> - how many equally spaced steps between <code class="docutils literal notranslate"><span class="pre">min_nugget</span></code> and <code class="docutils literal notranslate"><span class="pre">max_nugget</span></code> to check.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rang</span></code> - if given, then the <code class="docutils literal notranslate"><span class="pre">range</span></code> is fixed to this value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_range</span></code> - <strong>default = 0.1</strong> - the minimal fraction of a study (maximum) extent to find the optimal range.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_range</span></code> - <strong>default = 0.5</strong> - the maximum fraction of a study (maximum) extent to find the optimal range.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number_of_ranges</span></code> - <strong>default = 16</strong> - how many equally spaced ranges are tested between <code class="docutils literal notranslate"><span class="pre">min_range</span></code> and <code class="docutils literal notranslate"><span class="pre">max_range</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sill</span></code> - if given, it is fixed to this value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_sill</span></code> - <strong>default = 0</strong> - the minimal fraction of the dataset variance to find the <em>sill</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_sill</span></code> - <strong>default = 1</strong> - the maximum fraction of the dataset variance to find the <em>sill</em>. It should be lower or equal to 1, but it is possible to set it above. A warning is printed if <code class="docutils literal notranslate"><span class="pre">max_sill</span></code> is greater than 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number_of_sills</span></code> - <strong>default = 16</strong> - how many equally spaced sill values are tested between <code class="docutils literal notranslate"><span class="pre">min_sill</span></code> and <code class="docutils literal notranslate"><span class="pre">max_sill</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error_estimator</span></code> - <strong>default = ‘rmse’</strong> - Error estimation to choose the best model. Available options are:</p>
<ul>
<li><p>rmse: Root Mean Squared Error,</p></li>
<li><p>mae: Mean Absolute Error,</p></li>
<li><p>bias: Forecast Bias,</p></li>
<li><p>smape: Symmetric Mean Absolute Percentage Error.</p></li>
</ul>
</li>
</ul>
<p>In the first run, we will set nugget, sill, and range as fixed values, and we will see which model algorithm chooses:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">semivariogram_model</span> <span class="o">=</span> <span class="n">TheoreticalVariogram</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitted</span> <span class="o">=</span> <span class="n">semivariogram_model</span><span class="o">.</span><span class="n">autofit</span><span class="p">(</span>
    <span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
    <span class="n">nugget</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">rang</span><span class="o">=</span><span class="n">var_range</span><span class="p">,</span>
    <span class="n">sill</span><span class="o">=</span><span class="n">sill</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitted</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;model_name&#39;: &#39;linear&#39;,
 &#39;nugget&#39;: 0,
 &#39;sill&#39;: 489.8203263077297,
 &#39;range&#39;: 8000,
 &#39;fitted_model&#39;: array([[ 500.        ,   30.61377039],
        [1000.        ,   61.22754079],
        [1500.        ,   91.84131118],
        [2000.        ,  122.45508158],
        [2500.        ,  153.06885197],
        [3000.        ,  183.68262237],
        [3500.        ,  214.29639276],
        [4000.        ,  244.91016315],
        [4500.        ,  275.52393355],
        [5000.        ,  306.13770394],
        [5500.        ,  336.75147434],
        [6000.        ,  367.36524473],
        [6500.        ,  397.97901513],
        [7000.        ,  428.59278552],
        [7500.        ,  459.20655591],
        [8000.        ,  489.82032631],
        [8500.        ,  489.82032631],
        [9000.        ,  489.82032631],
        [9500.        ,  489.82032631]]),
 &#39;rmse&#39;: 28.218692107535404,
 &#39;bias&#39;: nan,
 &#39;mae&#39;: nan,
 &#39;smape&#39;: nan}
</pre></div></div>
</div>
<p>The chosen model is <strong>linear</strong>, automatically set as the class parameter. The algorithm performs the same steps as we did before. It has selected a model based on the RMSE. All other parameters were untouched.</p>
<p>Now, we let the algorithm find the optimal sill and range, and we check if our RMSE will be better with a different pair of sill and range:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitted</span> <span class="o">=</span> <span class="n">semivariogram_model</span><span class="o">.</span><span class="n">autofit</span><span class="p">(</span><span class="n">experimental_variogram</span><span class="o">=</span><span class="n">experimental_variogram</span><span class="p">,</span> <span class="n">nugget</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fitted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;model_name&#39;: &#39;linear&#39;, &#39;nugget&#39;: 0, &#39;sill&#39;: 489.8203263077297, &#39;range&#39;: 8990.27235812866, &#39;fitted_model&#39;: array([[ 500.        ,   27.2416845 ],
       [1000.        ,   54.483369  ],
       [1500.        ,   81.7250535 ],
       [2000.        ,  108.966738  ],
       [2500.        ,  136.2084225 ],
       [3000.        ,  163.450107  ],
       [3500.        ,  190.6917915 ],
       [4000.        ,  217.933476  ],
       [4500.        ,  245.1751605 ],
       [5000.        ,  272.41684501],
       [5500.        ,  299.65852951],
       [6000.        ,  326.90021401],
       [6500.        ,  354.14189851],
       [7000.        ,  381.38358301],
       [7500.        ,  408.62526751],
       [8000.        ,  435.86695201],
       [8500.        ,  463.10863651],
       [9000.        ,  489.82032631],
       [9500.        ,  489.82032631]]), &#39;rmse&#39;: 21.744673287932994, &#39;bias&#39;: nan, &#39;mae&#39;: nan, &#39;smape&#39;: nan}
</pre></div></div>
</div>
<p>After <code class="docutils literal notranslate"><span class="pre">.autofit()</span></code> our algorithm has chosen a different set of parameters and a model type! Let’s plot it against experimental variogram:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">semivariogram_model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_45_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_45_0.png" />
</div>
</div>
<p>Compare this model to the linear model fitted before:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_lags</span> <span class="o">=</span> <span class="n">semivariogram_model</span><span class="o">.</span><span class="n">lags</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">experimental_variogram</span><span class="o">.</span><span class="n">experimental_semivariances</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#762a83&#39;</span><span class="p">)</span>  <span class="c1"># Experimental</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">fitted_model</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;:p&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#e7d4e8&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_lags</span><span class="p">,</span> <span class="n">semivariogram_model</span><span class="o">.</span><span class="n">fitted_model</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1b7837&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of theoretical semivariance models&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Experimental Semivariance&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Cubic&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Semivariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/usage_tutorials_A11-Semivariogram-Estimation_47_0.png" src="../../_images/usage_tutorials_A11-Semivariogram-Estimation_47_0.png" />
</div>
</div>
</section>
<section id="5)-Export-model">
<h2>5) Export model<a class="headerlink" href="#5)-Export-model" title="Link to this heading">#</a></h2>
<p>Models could be exported and used for other purposes. It is vital for the <strong>semivariogram regularization</strong>. Those calculations are computationally intensive, and in production, it is not a good idea to build a complete pipeline; we divide it into two steps.</p>
<p>Model can be exported to <code class="docutils literal notranslate"><span class="pre">dict</span></code> with <code class="docutils literal notranslate"><span class="pre">.to_dict()</span></code> method or to <code class="docutils literal notranslate"><span class="pre">json</span></code> with <code class="docutils literal notranslate"><span class="pre">.to_json()</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set spherical model</span>

<span class="n">dict_model</span> <span class="o">=</span> <span class="n">semivariogram_model</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="c1"># Save to json</span>
<span class="n">semivariogram_model</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;output/semivariogram_calculation_model.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="6)-Import-model">
<h2>6) Import model<a class="headerlink" href="#6)-Import-model" title="Link to this heading">#</a></h2>
<p>We can import a semivariogram model into a new <strong>TheoreticalSemivariogram</strong> class instance without passing the experimental semivariogram or actual data points. It is helpful for some applications focused on kriging, where we are sure that our semivariogram model fits data well.</p>
<p>We can import a model with two methods <code class="docutils literal notranslate"><span class="pre">.from_dict()</span></code> if we have our model parameters in the Python dictionary or <code class="docutils literal notranslate"><span class="pre">.from_json()</span></code> if model parameters are stored in a flat file:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">other_model_from_dict</span> <span class="o">=</span> <span class="n">TheoreticalVariogram</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">other_model_from_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Theoretical model is not calculated yet. Use fit() or autofit() methods to build or find a model or import model with from_dict() or from_json() methods.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">other_model_from_dict</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">other_model_from_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Linear model
* Nugget: 0.0
* Sill: 489.8203263077297
* Range: 8990.27235812866
* Spatial Dependency Strength is Unknown
* Mean Bias: 0.0
* Mean RMSE: 0.0
* Error-lag weighting method: None
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">other_model_from_json</span> <span class="o">=</span> <span class="n">TheoreticalVariogram</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">other_model_from_json</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Theoretical model is not calculated yet. Use fit() or autofit() methods to build or find a model or import model with from_dict() or from_json() methods.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">other_model_from_json</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s1">&#39;output/semivariogram_calculation_model.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">other_model_from_json</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
* Selected model: Linear model
* Nugget: 0.0
* Sill: 489.8203263077297
* Range: 8990.27235812866
* Spatial Dependency Strength is Unknown
* Mean Bias: 0.0
* Mean RMSE: 0.0
* Error-lag weighting method: None

</pre></div></div>
</div>
<hr class="docutils" />
<p>Where to go from here?</p>
<ul class="simple">
<li><p>A.1.2 Theoretical Models</p></li>
<li><p>A.1.3 Spatial Dependence Index</p></li>
<li><p>A.2.1 Directional Semivariogram</p></li>
<li><p>A.2.2 Variogram Point Cloud</p></li>
<li><p>A.2.3 Experimental Variogram and Variogram Point Cloud Classes</p></li>
<li><p>B.1.1 Ordinary and Simple Kriging</p></li>
</ul>
</section>
<section id="Changelog">
<h2>Changelog<a class="headerlink" href="#Changelog" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Change description</p></th>
<th class="head"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2023-08-18</p></td>
<td><p>The tutorial was refreshed and set along with the 0.5.0 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2023-04-15</p></td>
<td><p>Tutorial debugged and updated to the 0.4.1 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2023-03-11</p></td>
<td><p>Spatial Dependence Index</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2022-11-05</p></td>
<td><p>Tutorial updated for the 0.3.5 version of the package</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2022-08-09</p></td>
<td><p>Tutorial updated to work with version 0.3.0</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2021-12-14</p></td>
<td><p>Sill selection was upgraded: now optimal sill is derived from the grid search within the <code class="docutils literal notranslate"><span class="pre">TheoreticalSemivariogram</span></code> class</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2021-12-13</p></td>
<td><p>Changed behavior of <code class="docutils literal notranslate"><span class="pre">select_values_in_range()</span></code> function</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2021-10-13</p></td>
<td><p>Refactored <code class="docutils literal notranslate"><span class="pre">TheoreticalSemivariogram</span></code> (name change of class attribute)</p></td>
<td><p>&#64;ethmtrgt</p></td>
</tr>
<tr class="row-even"><td><p>2021-05-28</p></td>
<td><p>Updated paths for input/output data</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-odd"><td><p>2021-05-11</p></td>
<td><p>Refactored <code class="docutils literal notranslate"><span class="pre">TheoreticalSemivariogram</span></code> class</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
<tr class="row-even"><td><p>2021-03-31</p></td>
<td><p>Update related to the change of semivariogram weighting</p></td>
<td><p>&#64;SimonMolinsky</p></td>
</tr>
</tbody>
</table>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../tutorials.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorials</p>
      </div>
    </a>
    <a class="right-next"
       href="A12-Theoretical-Models.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">A.1.2 Semivariogram models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Table-of-Contents:">Table of Contents:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Import-packages-and-modules">Import packages and modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1)-Read-point-data">1) Read point data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2)-Create-the-experimental-variogram">2) Create the experimental variogram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.-Set-manually-different-semivariogram-models">3. Set manually different semivariogram models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Models">Models</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4)-Set-automatically-semivariogram-model">4) Set automatically semivariogram model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#5)-Export-model">5) Export model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#6)-Import-model">6) Import model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Changelog">Changelog</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/usage/tutorials/A11-Semivariogram-Estimation.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Szymon Moliński.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>