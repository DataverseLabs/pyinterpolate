{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Poisson Kriging - centroid based approach - tutorial\n",
    "\n",
    "## Table of Contents:\n",
    "\n",
    "1. Load areal and point data,\n",
    "2. Load semivariogram (regularized),\n",
    "3. Remove 10% of areal dataset,\n",
    "4. Predict values at unknown locations,\n",
    "5. Analyse Forecast Bias and Root Mean Squared Error of prediction.\n",
    "\n",
    "#### Level: Advanced\n",
    "\n",
    "## Introduction\n",
    "\n",
    "To start this tutorial it is required to understand concepts in the **Ordinary and Simple Kriging** and **Semivariogram Regularization** tutorials.\n",
    "\n",
    "Poisson Kriging technique is used to model spatial count data. We are analyzing special case where data is counted over areas. Those areas may have irregular shapes and sizes beacuse they represent administrative regions. \n",
    "\n",
    "In this tutorial we try to predict rates of Breast Cancer in Pennsylvania counties. Along with areal data we use U.S. Census 2010 data for population blocks.\n",
    "\n",
    "> Breast cancer rates data is stored in the shapefile in folder `sample_data/areal_data/breast_cancer_rate_per_area_2.shp`.\n",
    "\n",
    "> Population blocks data is stored in the shapefile in folder `sample_data/population_data/population_blocks.shp`\n",
    "\n",
    "Even if our areal data has units with irregular shapes and sizes but for the case of this tutorial we assume that each region may be represented by its centroid. This is huge simplification but in some cases it could be taken into account. \n",
    "\n",
    "Centroid-based Poisson Kriging is much faster than Area-to-Area or Area-to-Point Poisson Kriging and for some applications it may be desired property.\n",
    "\n",
    "This tutorial covers following steps:\n",
    "\n",
    "1. Read and explore data,\n",
    "2. Load semivariogram model,\n",
    "3. Prepare training and test data,\n",
    "4. Predict values of unknown locations and calculate forecast bias and root mean squared error,\n",
    "5. Analyse error metrics."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1) Read and explore data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "\n",
    "from pyinterpolate.io_ops import prepare_areal_shapefile, get_points_within_area\n",
    "from pyinterpolate.semivariance import TheoreticalSemivariogram\n",
    "from pyinterpolate.kriging import CentroidPoissonKriging"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "areal_data_file = '../sample_data/areal_data/breast_cancer_rate_per_area_2.shp'\n",
    "point_data_file = '../sample_data/population_data/population_blocks.shp'\n",
    "\n",
    "areal_id_column_name = 'id'\n",
    "areal_val_column_name = 'rate'\n",
    "points_val_column_name = 'POPULATION'\n",
    "\n",
    "\n",
    "areal_data = prepare_areal_shapefile(areal_data_file,\n",
    "                                     id_column_name=areal_id_column_name,\n",
    "                                     value_column_name=areal_val_column_name)\n",
    "point_data = get_points_within_area(areal_data_file, point_data_file, areal_id_col_name=areal_id_column_name,\n",
    "                                   points_val_col_name=points_val_column_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7fe05908a250>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Lets take a look into a map of areal counts\n",
    "\n",
    "gdf = gpd.read_file(areal_data_file)\n",
    "gdf.plot(column='rate', cmap='Spectral_r', legend=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Clarification: \n",
    "\n",
    "It is good idea to look into the spatial patterns in dataset and to visually check if our data do not have any NaN values. We use geopandas GeoDataFrame plot function for it with color map which is diverging color classes well."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2) Load semivariogram model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In this step we load regularized semivariogram from the tutorial **Semivariogram Regularization (Intermediate)**. You can always perform semivariogram regulariztion along with the Poisson Kriging but it is a very long process and it is more convenient to separate those two steps."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "semivariogram = TheoreticalSemivariogram()  # Create TheoreticalSemivariogram object\n",
    "semivariogram.import_model('regularized_model.csv')  # Load regularized semivariogram"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3) Prepare training and test data\n",
    "\n",
    "We simply remove 10% of random ID's from areal dataset (the same for points) and create four arrays: two training arrays with areal and point geometry and values and two test arrays with the same categories of data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Remove 10% of rows (values) to test our model\n",
    "\n",
    "def create_test_areal_set(areal_dataset, points_dataset, frac=0.1):\n",
    "    \"\"\"\n",
    "    Function creates set with random areas for tests\n",
    "    \n",
    "    INPUT:\n",
    "    :param areal_dataset: (numpy array) array with rows of areal records,\n",
    "    :param points_dataset: (numpy array) array with rows of points records,\n",
    "    :param frac: (float) number of elements in a test set\n",
    "    \n",
    "    OUTPUT:\n",
    "    return: [training_set_areal(numpy array),\n",
    "             test_set_areal (numpy array),\n",
    "             training_set_points (numpy array),\n",
    "             test_set_points (numpy array)]\n",
    "    \"\"\"\n",
    "    \n",
    "    all_ids = areal_dataset[:, 0]\n",
    "    training_set_size = int(len(all_ids) * (1 - frac))\n",
    "    training_ids = np.random.choice(all_ids,\n",
    "                                    size=training_set_size,\n",
    "                                    replace=False)\n",
    "    training_areas = np.array(\n",
    "            [a for a in areal_dataset if a[0] in training_ids])\n",
    "    test_areas = np.array(\n",
    "            [a for a in areal_dataset if a[0] not in training_ids])\n",
    "    training_points = np.array(\n",
    "            [pt for pt in points_dataset if pt[0] in training_ids])\n",
    "    test_points = np.array(\n",
    "            [pt for pt in points_dataset if pt[0] not in training_ids])\n",
    "    \n",
    "\n",
    "    output = [training_areas, test_areas, training_points, test_points]\n",
    "    return output\n",
    "\n",
    "ar_train, ar_test, pt_train, pt_test = create_test_areal_set(areal_data, point_data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4) Predict values at unknown locations and calculate forecast bias and root mean squared error\n",
    "\n",
    "Do you know scikit-learn's fit-predict-transform estimation procedure? With Kriging it is more complicated because we are fitting semivariogram model to data and we pass this fitted model into kriging estimator. That's why package with *TheoreticalSemivariogram()* class is named **fit_semivariance**.\n",
    "You may start work with predictions with fitted semivariogram model. Centroid-based Poisson Kriging takes three arguments during initialization:\n",
    "\n",
    "=> semivariogram model (fitted semivariogram model),\n",
    "\n",
    "=> known areas (training set),\n",
    "\n",
    "=> known points (training set).\n",
    "\n",
    "After initilization you may perform prediction. This process requires you to control three hyperparameters:\n",
    "\n",
    "=> **number of observations** (the most important parameter - how many neighbors are affecting your area of analysis),\n",
    "\n",
    "=> minimum **search radius** (minimum search radius for analysis from your area of interest, if there are less areas than number of observations then the new, next closest neighbors are included in the analysis),\n",
    "\n",
    "=> **weighted** by population? (bool parameter, if True then distances are weighted by population between points - default is True for Poisson Kriging).\n",
    "\n",
    "Why **radius** parameter is less important than **number of observations**? It is a tradeoff between mathemtical accuracy and reality. Usually your areas of interest have different shapes and sizes and with very large county and small search radius from the centroid you may not find any neighbour!\n",
    "\n",
    "Algorithm in the cell below iteratively picks one area from the test set and perform prediction. Then forecast bias which is difference between real and predicted value is calculated. Forecast Bias is useful to understand if our algorithm predictions are too low or too high (under- or overestimation). The next parameter is Root Mean Squared Error. This kind of measure tells us more about outliers and very large differences between predictions and real values. We will see it in the last part of tutorial.\n",
    "\n",
    "Your work with Poisson Kriging (or Kriging) will be usually the same:\n",
    "- prepare training and test data,\n",
    "- use training data to prepare semivariogram model,\n",
    "- test different hyperparameters with a test set to find optimal number of neighbors which are affecting your area of analysis,\n",
    "- forecast into unknown areas OR perform data smoothing."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "number_of_obs = 8\n",
    "radius = 4\n",
    "\n",
    "kriging_model = CentroidPoissonKriging(semivariogram_model=semivariogram,\n",
    "                                       known_areas=ar_train,\n",
    "                                       known_areas_points=pt_train)\n",
    "c_predictions = []\n",
    "for unknown_area in ar_test:\n",
    "    unknown_points = pt_test[pt_test[:, 0] == unknown_area[0]][0]\n",
    "\n",
    "    # Predict\n",
    "    try:\n",
    "        predicted = kriging_model.predict(unknown_area,\n",
    "                                          unknown_points,\n",
    "                                          number_of_obs,\n",
    "                                          radius,\n",
    "                                          True)\n",
    "        predicted_accidents = int(predicted[0])\n",
    "        fb = (unknown_area[-1] - predicted_accidents)\n",
    "        rmse = np.sqrt((fb)**2)\n",
    "        \n",
    "        c_predictions.append([unknown_area[0], predicted_accidents, unknown_area[-1], fb, rmse])\n",
    "    except ValueError:\n",
    "        fb = np.nan\n",
    "        rmse = np.nan\n",
    "        c_predictions.append([unknown_area[0], np.nan, unknown_area[-1], fb, rmse])  # All NaN's"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "c_predictions = np.array(c_predictions)\n",
    "pred_df = pd.DataFrame(data=c_predictions[:, 1:],\n",
    "                       index=c_predictions[:, 0],\n",
    "                       columns=['predicted', 'real', 'forecast bias', 'rmse'])  # Store results in DataFrame"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5) Analyze Forecast Bias and Root Mean Squared Error of prediction\n",
    "\n",
    "The last step is analysis of errors. We plot two histograms: of forecast bias and of root mean squared error then we calculate base statistics of a dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7fe05724f590>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Show histograms of errors\n",
    "\n",
    "pred_df['forecast bias'].plot.hist(bins=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7fe057316090>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "pred_df['rmse'].plot.hist(bins=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>predicted</th>\n",
       "      <th>real</th>\n",
       "      <th>forecast bias</th>\n",
       "      <th>rmse</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>7.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>7.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>187.571429</td>\n",
       "      <td>132.928571</td>\n",
       "      <td>-54.642857</td>\n",
       "      <td>78.528571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>127.761310</td>\n",
       "      <td>7.929211</td>\n",
       "      <td>132.947344</td>\n",
       "      <td>118.169168</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>111.000000</td>\n",
       "      <td>123.100000</td>\n",
       "      <td>-323.900000</td>\n",
       "      <td>6.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>117.000000</td>\n",
       "      <td>128.100000</td>\n",
       "      <td>-67.850000</td>\n",
       "      <td>12.400000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>124.000000</td>\n",
       "      <td>131.400000</td>\n",
       "      <td>11.400000</td>\n",
       "      <td>19.100000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>198.500000</td>\n",
       "      <td>137.800000</td>\n",
       "      <td>16.250000</td>\n",
       "      <td>87.700000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>447.000000</td>\n",
       "      <td>144.200000</td>\n",
       "      <td>33.200000</td>\n",
       "      <td>323.900000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        predicted        real  forecast bias        rmse\n",
       "count    7.000000    7.000000       7.000000    7.000000\n",
       "mean   187.571429  132.928571     -54.642857   78.528571\n",
       "std    127.761310    7.929211     132.947344  118.169168\n",
       "min    111.000000  123.100000    -323.900000    6.500000\n",
       "25%    117.000000  128.100000     -67.850000   12.400000\n",
       "50%    124.000000  131.400000      11.400000   19.100000\n",
       "75%    198.500000  137.800000      16.250000   87.700000\n",
       "max    447.000000  144.200000      33.200000  323.900000"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pred_df.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Clarification:\n",
    "\n",
    "1. **Forecast Bias** histogram shows tendency towards negative values due to the two large predictions which overestimated real infection rate. Standard Deviation of Forecast Bias is large but you must have in mind that we test only 7 values per scenario and one or two outliers have large impact on the final result.\n",
    "2. **Root Mean Squared Error** histogram is skewed towards the 0. Unfortunatelely our predictions have outliers (75% of error values above 87). The mean error is close to 78 cases per area which is 50% of a mean of real observations... and it's too much. Model is not performing well.\n",
    "\n",
    "##### NOTE:\n",
    "\n",
    "Those results are not decisive. Our sample is very small and output could be related to very unfortunate sampling over areas. The good idea is to repeat experiment multiple times with other samples and average results to find out how well model is performing."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "---"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
