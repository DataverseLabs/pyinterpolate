
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram &#8212; Pyinterpolate 0.2.0 documentation</title>
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram</h1><div class="highlight"><pre>
<span></span><span class="c1"># Base libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Data vizualization libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Pyinterpolate libraries</span>
<span class="kn">from</span> <span class="nn">pyinterpolate.semivariance.areal_semivariance.areal_semivariance</span> <span class="kn">import</span> <span class="n">ArealSemivariance</span>
<span class="kn">from</span> <span class="nn">pyinterpolate.semivariance.semivariogram_fit.fit_semivariance</span> <span class="kn">import</span> <span class="n">TheoreticalSemivariogram</span>
<span class="kn">from</span> <span class="nn">pyinterpolate.semivariance.semivariogram_estimation.calculate_semivariance</span> <span class="kn">import</span> \
    <span class="n">calculate_semivariance</span>  <span class="c1"># Experimental semivariogram</span>


<div class="viewcode-block" id="RegularizedSemivariogram"><a class="viewcode-back" href="../../../../index.html#pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram.RegularizedSemivariogram">[docs]</a><span class="k">class</span> <span class="nc">RegularizedSemivariogram</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class performs deconvolution of semivariogram of areal data. Whole procedure is based on the iterative process</span>
<span class="sd">    described in: Goovaerts P., Kriging and Semivariogram Deconvolution in the Presence of Irregular Geographical</span>
<span class="sd">    Units, Mathematical Geology 40(1), 101-128, 2008.</span>

<span class="sd">    Class works as follow:</span>

<span class="sd">    - initialize your object (no parameters),</span>
<span class="sd">    - then use fit() method to build initial point support model,</span>
<span class="sd">    - the use transform() method to perform semivariogram regularization.</span>

<span class="sd">    Class public methods:</span>

<span class="sd">    fit() - fits areal data and point support data into a model, initialize experimental semivariogram,</span>
<span class="sd">    theoretical semivariogram model, regularized point support model and deviation.</span>

<span class="sd">    transform() - performs semivariogram regularization, which is an iterative process.</span>

<span class="sd">    show_semivariograms() - plots experimental semivariogram of areal data, theoretical curve of areal data,</span>
<span class="sd">    regularized model values and regularized model theoretical curve.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class has multiple params, some of them are designed to control process of regularization and other are storing</span>
<span class="sd">        semivariogram models and experimental (or regularized) values of semivariance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Procedure control parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iters</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">deviation_ratio</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_deviation_ratio</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">diff_decrease</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_diff_decrease</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">const_d_stat_reps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_diff_decrease_reps</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weight_error_lags</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weight_change</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store_models</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Regularization parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Initial semivariogram models and parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_regularized_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_deviation</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Temporary semivariogram models and class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_experimental_semivariogram</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_regularized_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Optimal semivariogram models and params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_theoretical_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Final models</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_theoretical_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_optimal_model</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areal_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areal_lags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areal_step_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_support_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Stored models if self.store_models is True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_exp_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_theo_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_reg_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_regularize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">empirical_semivariance</span><span class="p">,</span> <span class="n">semivariance_model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function regularizes semivariogram with ArealSemivariance class.</span>

<span class="sd">        INPUT:</span>

<span class="sd">        :param empirical_semivariance: experimental values of semivariance as an array of the form:</span>
<span class="sd">            [[column with lags, column with values, column with number of points within lag]],</span>
<span class="sd">        :param semivariance_model: TheoreticalSemivariance model,</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">        :return: regularized semivariance values (array).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize areal semivariance object</span>
        <span class="n">areal_semivariance</span> <span class="o">=</span> <span class="n">ArealSemivariance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areal_data</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">areal_lags</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">areal_step_size</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">point_support_data</span><span class="p">,</span>
                                               <span class="n">weighted_semivariance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_error_lags</span><span class="p">)</span>

        <span class="c1"># Regularize semivariogram of areal data</span>
        <span class="n">theoretically_regularized_model_values</span> <span class="o">=</span> <span class="n">areal_semivariance</span><span class="o">.</span><span class="n">regularize_semivariogram</span><span class="p">(</span>
            <span class="n">empirical_semivariance</span><span class="o">=</span><span class="n">empirical_semivariance</span><span class="p">,</span>
            <span class="n">theoretical_semivariance_model</span><span class="o">=</span><span class="n">semivariance_model</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">theoretically_regularized_model_values</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_calculate_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regularized_model</span><span class="p">,</span> <span class="n">theoretical_model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function calculates deviation between experimental and theoretical semivariogram over given lags.</span>

<span class="sd">        INPUT:</span>

<span class="sd">        :param regularized_model: (numpy array) array of the values generated for the regularized model,</span>
<span class="sd">        :param theoretical_model: (TheoreticalSemivariance) theoretical model of data,</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">        :return deviation: (float) scalar which describes deviation between semivariograms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areal_lags</span>
        <span class="n">theoretical_values</span> <span class="o">=</span> <span class="n">theoretical_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
        <span class="n">regularized_values</span> <span class="o">=</span> <span class="n">regularized_model</span>

        <span class="n">deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">regularized_values</span> <span class="o">-</span> <span class="n">theoretical_values</span><span class="p">)</span>
        <span class="n">deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">deviation</span><span class="p">,</span>
                              <span class="n">theoretical_values</span><span class="p">,</span>
                              <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">deviation</span><span class="p">),</span>
                              <span class="n">where</span><span class="o">=</span><span class="n">theoretical_values</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">deviation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">deviation</span>

    <span class="k">def</span> <span class="nf">_rescale_optimal_point_support</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function rescales the optimal point support model and creates new experimental values for each lag based on</span>
<span class="sd">            the equation:</span>

<span class="sd">            y(1)(h) = y_opt(h) x w(h)</span>

<span class="sd">            w(h) = 1 + [(y_exp_v(h) - y_opt_v(h) / (s^2 * sqrt(iter))]</span>

<span class="sd">            where:</span>

<span class="sd">            - s = sill of the model y_exp_v</span>
<span class="sd">            - iter = iteration number</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">        :return rescalled_point_support_semivariogram: (numpy array) of the form [[lag, semivariance, number of points]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areal_lags</span>

        <span class="n">y_opt_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_theoretical_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_change</span><span class="p">:</span>
            <span class="n">sill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">denominator</span> <span class="o">=</span> <span class="n">sill</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span>

            <span class="n">y_exp_v_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
            <span class="n">y_opt_v_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span>

            <span class="n">numerator</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_exp_v_h</span> <span class="o">-</span> <span class="n">y_opt_v_h</span><span class="p">)</span>

            <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">rescalled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">rescalled</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_opt_h</span> <span class="o">*</span> <span class="n">w</span>

        <span class="k">return</span> <span class="n">rescalled</span><span class="p">,</span> <span class="n">w</span>

    <span class="k">def</span> <span class="nf">_check_deviation_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deviation_ratio</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_deviation_ratio</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_loop_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iters</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_diff_d_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diff_decrease</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_diff_decrease</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">const_d_stat_reps</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_diff_decrease_reps</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">const_d_stat_reps</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">const_d_stat_reps</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">const_d_stat_reps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">const_d_stat_reps</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_check_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_deviation_ratio</span><span class="p">()</span>  <span class="c1"># Default False</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_diff_d_stat</span><span class="p">()</span>  <span class="c1"># Default False</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_loop_limit</span><span class="p">()</span>  <span class="c1"># Default False</span>

        <span class="n">cond</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t1</span> <span class="ow">or</span> <span class="n">t2</span> <span class="ow">or</span> <span class="n">t3</span><span class="p">)</span>  <span class="c1"># Default False</span>

        <span class="k">return</span> <span class="n">cond</span>

<div class="viewcode-block" id="RegularizedSemivariogram.fit"><a class="viewcode-back" href="../../../../index.html#pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram.RegularizedSemivariogram.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">areal_data</span><span class="p">,</span> <span class="n">areal_lags</span><span class="p">,</span> <span class="n">areal_step_size</span><span class="p">,</span>
            <span class="n">point_support_data</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">weighted_lags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">store_models</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function fits areal and point support data to the initial regularized models.</span>

<span class="sd">        INPUT:</span>

<span class="sd">        :param areal_data: areal data prepared with the function prepare_areal_shapefile(), where data is a numpy array</span>
<span class="sd">            in the form: [area_id, area_geometry, centroid coordinate x, centroid coordinate y, value],</span>
<span class="sd">        :param areal_lags: list of lags between each distance,</span>
<span class="sd">        :param areal_step_size: step size between each lag, usually it is a half of distance between lags,</span>
<span class="sd">        :param point_support_data: point support data prepared with the function get_points_within_area(), where data is</span>
<span class="sd">            a numpy array in the form: [area_id, [point_position_x, point_position_y, value]],</span>
<span class="sd">        :param ranges: (int) number of ranges to test during semivariogram fitting. More steps == more accurate nugget</span>
<span class="sd">            and range prediction, but longer calculations,</span>
<span class="sd">        :param weighted_lags: (bool) lags weighted by number of points; if True then during semivariogram fitting error</span>
<span class="sd">            of each model is weighted by number of points for each lag. In practice it means that more reliable data</span>
<span class="sd">            (lags) have larger weights and semivariogram is modeled to better fit to those lags,</span>
<span class="sd">        :param store_models: (bool) if True then experimental, regularized and theoretical models are stored in lists</span>
<span class="sd">            after each iteration. It is important for a debugging process.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Update data class params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areal_data</span> <span class="o">=</span> <span class="n">areal_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areal_lags</span> <span class="o">=</span> <span class="n">areal_lags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areal_step_size</span> <span class="o">=</span> <span class="n">areal_step_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_support_data</span> <span class="o">=</span> <span class="n">point_support_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span> <span class="o">=</span> <span class="n">ranges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_error_lags</span> <span class="o">=</span> <span class="n">weighted_lags</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store_models</span> <span class="o">=</span> <span class="n">store_models</span>

        <span class="c1"># Compute experimental semivariogram of areal data from areal centroids</span>

        <span class="n">areal_centroids</span> <span class="o">=</span> <span class="n">areal_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span> <span class="o">=</span> <span class="n">calculate_semivariance</span><span class="p">(</span>
            <span class="n">areal_centroids</span><span class="p">,</span>
            <span class="n">areal_lags</span><span class="p">,</span>
            <span class="n">areal_step_size</span>
        <span class="p">)</span>

        <span class="c1"># Compute theoretical semivariogram of areal data from areal centroids</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span> <span class="o">=</span> <span class="n">TheoreticalSemivariogram</span><span class="p">(</span>
            <span class="n">areal_centroids</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="o">.</span><span class="n">find_optimal_model</span><span class="p">(</span>
            <span class="n">weighted</span><span class="o">=</span><span class="n">weighted_lags</span><span class="p">,</span>
            <span class="n">number_of_ranges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges</span>
        <span class="p">)</span>

        <span class="c1"># Regularize model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_regularized_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regularize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="p">,</span>
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="p">)</span>

        <span class="c1"># Calculate d-stat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_deviation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_deviation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_regularized_model</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_deviation</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedSemivariogram.transform"><a class="viewcode-back" href="../../../../index.html#pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram.RegularizedSemivariogram.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_iters</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">min_deviation_ratio</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">min_diff_decrease</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">min_diff_decrease_reps</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function transofrms fitted data and performs semivariogram regularziation iterative procedure.</span>

<span class="sd">        INPUT:</span>

<span class="sd">        :param max_iters: maximum number of iterations,</span>
<span class="sd">        :param min_deviation_ratio: minimum ration between deviation and initial deviation (D(i) / D(0)) below each</span>
<span class="sd">            algorithm is stopped,</span>
<span class="sd">        :param min_diff_decrease: minimum absolute difference between new and optimal deviation divided by optimal</span>
<span class="sd">            deviation: ABS(D(i) - D(opt)) / D(opt). If it is recorded n times (controled by the min_diff_d_stat_reps</span>
<span class="sd">            param) then algorithm is stopped,</span>
<span class="sd">        :param min_diff_decrease_reps: (int) number of iterations when algorithm is stopped if condition</span>
<span class="sd">            min_diff_d_stat is fulfilled.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check if data is fitted</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_regularized_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Before transform you must fit areal data and calculate initial point support models&#39;</span><span class="p">)</span>

        <span class="c1"># Update class control params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iters</span> <span class="o">=</span> <span class="n">max_iters</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_deviation_ratio</span> <span class="o">=</span> <span class="n">min_deviation_ratio</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_diff_decrease</span> <span class="o">=</span> <span class="n">min_diff_decrease</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_diff_decrease_reps</span> <span class="o">=</span> <span class="n">min_diff_decrease_reps</span>

        <span class="c1"># Update initial optimal models</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_theoretical_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_regularized_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_deviation</span>

        <span class="c1"># Prepare semivariogram modeling data</span>
        <span class="n">areal_centroids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">areal_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>
        <span class="n">ranges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span>
        <span class="n">is_weighted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_error_lags</span>

        <span class="c1"># Append initial models if self.store_models is True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store_models</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t_theo_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optimal_theoretical_model</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t_reg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t_exp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="p">)</span>

        <span class="c1"># Start iteration procedure</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_algorithm</span><span class="p">():</span>
            <span class="c1"># Compute new experimental values for new experimental point support model</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">temp_experimental_semivariogram</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescale_optimal_point_support</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

            <span class="c1"># Fit rescaled empirical semivariogram to the new theoretical function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span> <span class="o">=</span> <span class="n">TheoreticalSemivariogram</span><span class="p">(</span><span class="n">areal_centroids</span><span class="p">,</span>
                                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">temp_experimental_semivariogram</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span><span class="o">.</span><span class="n">find_optimal_model</span><span class="p">(</span>
                <span class="n">weighted</span><span class="o">=</span><span class="n">is_weighted</span><span class="p">,</span>
                <span class="n">number_of_ranges</span><span class="o">=</span><span class="n">ranges</span>
            <span class="p">)</span>

            <span class="c1"># Regularize model</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temp_regularized_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regularize</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temp_experimental_semivariogram</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span>
            <span class="p">)</span>

            <span class="c1"># Compute difference statistics</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_deviation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_regularized_model</span><span class="p">,</span>
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weight_change</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">diff_decrease</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deviation_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span>

                <span class="c1"># Update models</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optimal_theoretical_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_regularized_model</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weight_change</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_deviation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># Update models if self.store_models is set to True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store_models</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_theo_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_exp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_experimental_semivariogram</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t_reg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_regularized_model</span><span class="p">)</span>

        <span class="c1"># Get theoretical model from regularized</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_theoretical_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_theoretical_semivariogram_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_optimal_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span></div>

<div class="viewcode-block" id="RegularizedSemivariogram.export_regularized_model"><a class="viewcode-back" href="../../../../index.html#pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram.RegularizedSemivariogram.export_regularized_model">[docs]</a>    <span class="k">def</span> <span class="nf">export_regularized_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function exports final regularized model parameters into specified csv file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_theoretical_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You cannot export any model if you not transform data.&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">final_theoretical_model</span><span class="o">.</span><span class="n">export_model</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedSemivariogram.show_baseline_semivariograms"><a class="viewcode-back" href="../../../../index.html#pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram.RegularizedSemivariogram.show_baseline_semivariograms">[docs]</a>    <span class="k">def</span> <span class="nf">show_baseline_semivariograms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function shows experimental semivariogram, initial theoretical semivariogram and</span>
<span class="sd">        initial regularized semivariogram after fit() operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">lags</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_regularized_model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Experimental semivariogram of areal data&#39;</span><span class="p">,</span> <span class="s1">&#39;Initial Semivariogram of areal data&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Regularized data points&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Semivariograms comparison. Deviation value: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_deviation</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Semivariance&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="RegularizedSemivariogram.show_semivariograms"><a class="viewcode-back" href="../../../../index.html#pyinterpolate.semivariance.semivariogram_deconvolution.regularize_semivariogram.RegularizedSemivariogram.show_semivariograms">[docs]</a>    <span class="k">def</span> <span class="nf">show_semivariograms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function shows experimental semivariogram, theoretical semivariogram and regularized semivariogram after</span>
<span class="sd">        semivariogram regularization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">experimental_semivariogram_of_areal_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">initial_theoretical_model_of_areal_data</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">lags</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_regularized_model</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span>
                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">optimal_theoretical_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">lags</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Experimental semivariogram of areal data&#39;</span><span class="p">,</span> <span class="s1">&#39;Initial Semivariogram of areal data&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Regularized data points, iteration </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">),</span>
                    <span class="s1">&#39;Optimized theoretical point support model&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Semivariograms comparison. Deviation value: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optimal_deviation</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Semivariance&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">Pyinterpolate</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Szymon Moliński.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>